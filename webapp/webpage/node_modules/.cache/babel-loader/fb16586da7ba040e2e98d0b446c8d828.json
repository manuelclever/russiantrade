{"ast":null,"code":"(function (f) {\n  if (typeof exports === \"object\" && typeof module !== \"undefined\") {\n    module.exports = f();\n  } else if (typeof define === \"function\" && define.amd) {\n    define([], f);\n  } else {\n    var g;\n\n    if (typeof window !== \"undefined\") {\n      g = window;\n    } else if (typeof global !== \"undefined\") {\n      g = global;\n    } else if (typeof self !== \"undefined\") {\n      g = self;\n    } else {\n      g = this;\n    }\n\n    g.panzoom = f();\n  }\n})(function () {\n  var define, module, exports;\n  return function () {\n    function r(e, n, t) {\n      function o(i, f) {\n        if (!n[i]) {\n          if (!e[i]) {\n            var c = \"function\" == typeof require && require;\n            if (!f && c) return c(i, !0);\n            if (u) return u(i, !0);\n            var a = new Error(\"Cannot find module '\" + i + \"'\");\n            throw a.code = \"MODULE_NOT_FOUND\", a;\n          }\n\n          var p = n[i] = {\n            exports: {}\n          };\n          e[i][0].call(p.exports, function (r) {\n            var n = e[i][1][r];\n            return o(n || r);\n          }, p, p.exports, r, e, n, t);\n        }\n\n        return n[i].exports;\n      }\n\n      for (var u = \"function\" == typeof require && require, i = 0; i < t.length; i++) o(t[i]);\n\n      return o;\n    }\n\n    return r;\n  }()({\n    1: [function (require, module, exports) {\n      'use strict';\n      /**\n       * Allows to drag and zoom svg elements\n       */\n\n      var wheel = require('wheel');\n\n      var animate = require('amator');\n\n      var eventify = require('ngraph.events');\n\n      var kinetic = require('./lib/kinetic.js');\n\n      var createTextSelectionInterceptor = require('./lib/createTextSelectionInterceptor.js');\n\n      var domTextSelectionInterceptor = createTextSelectionInterceptor();\n      var fakeTextSelectorInterceptor = createTextSelectionInterceptor(true);\n\n      var Transform = require('./lib/transform.js');\n\n      var makeSvgController = require('./lib/svgController.js');\n\n      var makeDomController = require('./lib/domController.js');\n\n      var defaultZoomSpeed = 1;\n      var defaultDoubleTapZoomSpeed = 1.75;\n      var doubleTapSpeedInMS = 300;\n      module.exports = createPanZoom;\n      /**\n       * Creates a new instance of panzoom, so that an object can be panned and zoomed\n       *\n       * @param {DOMElement} domElement where panzoom should be attached.\n       * @param {Object} options that configure behavior.\n       */\n\n      function createPanZoom(domElement, options) {\n        options = options || {};\n        var panController = options.controller;\n\n        if (!panController) {\n          if (makeSvgController.canAttach(domElement)) {\n            panController = makeSvgController(domElement, options);\n          } else if (makeDomController.canAttach(domElement)) {\n            panController = makeDomController(domElement, options);\n          }\n        }\n\n        if (!panController) {\n          throw new Error('Cannot create panzoom for the current type of dom element');\n        }\n\n        var owner = panController.getOwner(); // just to avoid GC pressure, every time we do intermediate transform\n        // we return this object. For internal use only. Never give it back to the consumer of this library\n\n        var storedCTMResult = {\n          x: 0,\n          y: 0\n        };\n        var isDirty = false;\n        var transform = new Transform();\n\n        if (panController.initTransform) {\n          panController.initTransform(transform);\n        }\n\n        var filterKey = typeof options.filterKey === 'function' ? options.filterKey : noop; // TODO: likely need to unite pinchSpeed with zoomSpeed\n\n        var pinchSpeed = typeof options.pinchSpeed === 'number' ? options.pinchSpeed : 1;\n        var bounds = options.bounds;\n        var maxZoom = typeof options.maxZoom === 'number' ? options.maxZoom : Number.POSITIVE_INFINITY;\n        var minZoom = typeof options.minZoom === 'number' ? options.minZoom : 0;\n        var boundsPadding = typeof options.boundsPadding === 'number' ? options.boundsPadding : 0.05;\n        var zoomDoubleClickSpeed = typeof options.zoomDoubleClickSpeed === 'number' ? options.zoomDoubleClickSpeed : defaultDoubleTapZoomSpeed;\n        var beforeWheel = options.beforeWheel || noop;\n        var beforeMouseDown = options.beforeMouseDown || noop;\n        var speed = typeof options.zoomSpeed === 'number' ? options.zoomSpeed : defaultZoomSpeed;\n        var transformOrigin = parseTransformOrigin(options.transformOrigin);\n        var textSelection = options.enableTextSelection ? fakeTextSelectorInterceptor : domTextSelectionInterceptor;\n        validateBounds(bounds);\n\n        if (options.autocenter) {\n          autocenter();\n        }\n\n        var frameAnimation;\n        var lastTouchEndTime = 0;\n        var lastSingleFingerOffset;\n        var touchInProgress = false; // We only need to fire panstart when actual move happens\n\n        var panstartFired = false; // cache mouse coordinates here\n\n        var mouseX;\n        var mouseY;\n        var pinchZoomLength;\n        var smoothScroll;\n\n        if ('smoothScroll' in options && !options.smoothScroll) {\n          // If user explicitly asked us not to use smooth scrolling, we obey\n          smoothScroll = rigidScroll();\n        } else {\n          // otherwise we use forward smoothScroll settings to kinetic API\n          // which makes scroll smoothing.\n          smoothScroll = kinetic(getPoint, scroll, options.smoothScroll);\n        }\n\n        var moveByAnimation;\n        var zoomToAnimation;\n        var multiTouch;\n        var paused = false;\n        listenForEvents();\n        var api = {\n          dispose: dispose,\n          moveBy: internalMoveBy,\n          moveTo: moveTo,\n          smoothMoveTo: smoothMoveTo,\n          centerOn: centerOn,\n          zoomTo: publicZoomTo,\n          zoomAbs: zoomAbs,\n          smoothZoom: smoothZoom,\n          smoothZoomAbs: smoothZoomAbs,\n          showRectangle: showRectangle,\n          pause: pause,\n          resume: resume,\n          isPaused: isPaused,\n          getTransform: getTransformModel,\n          getMinZoom: getMinZoom,\n          setMinZoom: setMinZoom,\n          getMaxZoom: getMaxZoom,\n          setMaxZoom: setMaxZoom,\n          getTransformOrigin: getTransformOrigin,\n          setTransformOrigin: setTransformOrigin,\n          getZoomSpeed: getZoomSpeed,\n          setZoomSpeed: setZoomSpeed\n        };\n        eventify(api);\n        var initialX = typeof options.initialX === 'number' ? options.initialX : transform.x;\n        var initialY = typeof options.initialY === 'number' ? options.initialY : transform.y;\n        var initialZoom = typeof options.initialZoom === 'number' ? options.initialZoom : transform.scale;\n\n        if (initialX != transform.x || initialY != transform.y || initialZoom != transform.scale) {\n          zoomAbs(initialX, initialY, initialZoom);\n        }\n\n        return api;\n\n        function pause() {\n          releaseEvents();\n          paused = true;\n        }\n\n        function resume() {\n          if (paused) {\n            listenForEvents();\n            paused = false;\n          }\n        }\n\n        function isPaused() {\n          return paused;\n        }\n\n        function showRectangle(rect) {\n          // TODO: this duplicates autocenter. I think autocenter should go.\n          var clientRect = owner.getBoundingClientRect();\n          var size = transformToScreen(clientRect.width, clientRect.height);\n          var rectWidth = rect.right - rect.left;\n          var rectHeight = rect.bottom - rect.top;\n\n          if (!Number.isFinite(rectWidth) || !Number.isFinite(rectHeight)) {\n            throw new Error('Invalid rectangle');\n          }\n\n          var dw = size.x / rectWidth;\n          var dh = size.y / rectHeight;\n          var scale = Math.min(dw, dh);\n          transform.x = -(rect.left + rectWidth / 2) * scale + size.x / 2;\n          transform.y = -(rect.top + rectHeight / 2) * scale + size.y / 2;\n          transform.scale = scale;\n        }\n\n        function transformToScreen(x, y) {\n          if (panController.getScreenCTM) {\n            var parentCTM = panController.getScreenCTM();\n            var parentScaleX = parentCTM.a;\n            var parentScaleY = parentCTM.d;\n            var parentOffsetX = parentCTM.e;\n            var parentOffsetY = parentCTM.f;\n            storedCTMResult.x = x * parentScaleX - parentOffsetX;\n            storedCTMResult.y = y * parentScaleY - parentOffsetY;\n          } else {\n            storedCTMResult.x = x;\n            storedCTMResult.y = y;\n          }\n\n          return storedCTMResult;\n        }\n\n        function autocenter() {\n          var w; // width of the parent\n\n          var h; // height of the parent\n\n          var left = 0;\n          var top = 0;\n          var sceneBoundingBox = getBoundingBox();\n\n          if (sceneBoundingBox) {\n            // If we have bounding box - use it.\n            left = sceneBoundingBox.left;\n            top = sceneBoundingBox.top;\n            w = sceneBoundingBox.right - sceneBoundingBox.left;\n            h = sceneBoundingBox.bottom - sceneBoundingBox.top;\n          } else {\n            // otherwise just use whatever space we have\n            var ownerRect = owner.getBoundingClientRect();\n            w = ownerRect.width;\n            h = ownerRect.height;\n          }\n\n          var bbox = panController.getBBox();\n\n          if (bbox.width === 0 || bbox.height === 0) {\n            // we probably do not have any elements in the SVG\n            // just bail out;\n            return;\n          }\n\n          var dh = h / bbox.height;\n          var dw = w / bbox.width;\n          var scale = Math.min(dw, dh);\n          transform.x = -(bbox.left + bbox.width / 2) * scale + w / 2 + left;\n          transform.y = -(bbox.top + bbox.height / 2) * scale + h / 2 + top;\n          transform.scale = scale;\n        }\n\n        function getTransformModel() {\n          // TODO: should this be read only?\n          return transform;\n        }\n\n        function getMinZoom() {\n          return minZoom;\n        }\n\n        function setMinZoom(newMinZoom) {\n          minZoom = newMinZoom;\n        }\n\n        function getMaxZoom() {\n          return maxZoom;\n        }\n\n        function setMaxZoom(newMaxZoom) {\n          maxZoom = newMaxZoom;\n        }\n\n        function getTransformOrigin() {\n          return transformOrigin;\n        }\n\n        function setTransformOrigin(newTransformOrigin) {\n          transformOrigin = parseTransformOrigin(newTransformOrigin);\n        }\n\n        function getZoomSpeed() {\n          return speed;\n        }\n\n        function setZoomSpeed(newSpeed) {\n          if (!Number.isFinite(newSpeed)) {\n            throw new Error('Zoom speed should be a number');\n          }\n\n          speed = newSpeed;\n        }\n\n        function getPoint() {\n          return {\n            x: transform.x,\n            y: transform.y\n          };\n        }\n\n        function moveTo(x, y) {\n          transform.x = x;\n          transform.y = y;\n          keepTransformInsideBounds();\n          triggerEvent('pan');\n          makeDirty();\n        }\n\n        function moveBy(dx, dy) {\n          moveTo(transform.x + dx, transform.y + dy);\n        }\n\n        function keepTransformInsideBounds() {\n          var boundingBox = getBoundingBox();\n          if (!boundingBox) return;\n          var adjusted = false;\n          var clientRect = getClientRect();\n          var diff = boundingBox.left - clientRect.right;\n\n          if (diff > 0) {\n            transform.x += diff;\n            adjusted = true;\n          } // check the other side:\n\n\n          diff = boundingBox.right - clientRect.left;\n\n          if (diff < 0) {\n            transform.x += diff;\n            adjusted = true;\n          } // y axis:\n\n\n          diff = boundingBox.top - clientRect.bottom;\n\n          if (diff > 0) {\n            // we adjust transform, so that it matches exactly our bounding box:\n            // transform.y = boundingBox.top - (boundingBox.height + boundingBox.y) * transform.scale =>\n            // transform.y = boundingBox.top - (clientRect.bottom - transform.y) =>\n            // transform.y = diff + transform.y =>\n            transform.y += diff;\n            adjusted = true;\n          }\n\n          diff = boundingBox.bottom - clientRect.top;\n\n          if (diff < 0) {\n            transform.y += diff;\n            adjusted = true;\n          }\n\n          return adjusted;\n        }\n        /**\n         * Returns bounding box that should be used to restrict scene movement.\n         */\n\n\n        function getBoundingBox() {\n          if (!bounds) return; // client does not want to restrict movement\n\n          if (typeof bounds === 'boolean') {\n            // for boolean type we use parent container bounds\n            var ownerRect = owner.getBoundingClientRect();\n            var sceneWidth = ownerRect.width;\n            var sceneHeight = ownerRect.height;\n            return {\n              left: sceneWidth * boundsPadding,\n              top: sceneHeight * boundsPadding,\n              right: sceneWidth * (1 - boundsPadding),\n              bottom: sceneHeight * (1 - boundsPadding)\n            };\n          }\n\n          return bounds;\n        }\n\n        function getClientRect() {\n          var bbox = panController.getBBox();\n          var leftTop = client(bbox.left, bbox.top);\n          return {\n            left: leftTop.x,\n            top: leftTop.y,\n            right: bbox.width * transform.scale + leftTop.x,\n            bottom: bbox.height * transform.scale + leftTop.y\n          };\n        }\n\n        function client(x, y) {\n          return {\n            x: x * transform.scale + transform.x,\n            y: y * transform.scale + transform.y\n          };\n        }\n\n        function makeDirty() {\n          isDirty = true;\n          frameAnimation = window.requestAnimationFrame(frame);\n        }\n\n        function zoomByRatio(clientX, clientY, ratio) {\n          if (isNaN(clientX) || isNaN(clientY) || isNaN(ratio)) {\n            throw new Error('zoom requires valid numbers');\n          }\n\n          var newScale = transform.scale * ratio;\n\n          if (newScale < minZoom) {\n            if (transform.scale === minZoom) return;\n            ratio = minZoom / transform.scale;\n          }\n\n          if (newScale > maxZoom) {\n            if (transform.scale === maxZoom) return;\n            ratio = maxZoom / transform.scale;\n          }\n\n          var size = transformToScreen(clientX, clientY);\n          transform.x = size.x - ratio * (size.x - transform.x);\n          transform.y = size.y - ratio * (size.y - transform.y); // TODO: https://github.com/anvaka/panzoom/issues/112\n\n          if (bounds && boundsPadding === 1 && minZoom === 1) {\n            transform.scale *= ratio;\n            keepTransformInsideBounds();\n          } else {\n            var transformAdjusted = keepTransformInsideBounds();\n            if (!transformAdjusted) transform.scale *= ratio;\n          }\n\n          triggerEvent('zoom');\n          makeDirty();\n        }\n\n        function zoomAbs(clientX, clientY, zoomLevel) {\n          var ratio = zoomLevel / transform.scale;\n          zoomByRatio(clientX, clientY, ratio);\n        }\n\n        function centerOn(ui) {\n          var parent = ui.ownerSVGElement;\n          if (!parent) throw new Error('ui element is required to be within the scene'); // TODO: should i use controller's screen CTM?\n\n          var clientRect = ui.getBoundingClientRect();\n          var cx = clientRect.left + clientRect.width / 2;\n          var cy = clientRect.top + clientRect.height / 2;\n          var container = parent.getBoundingClientRect();\n          var dx = container.width / 2 - cx;\n          var dy = container.height / 2 - cy;\n          internalMoveBy(dx, dy, true);\n        }\n\n        function smoothMoveTo(x, y) {\n          internalMoveBy(x - transform.x, y - transform.y, true);\n        }\n\n        function internalMoveBy(dx, dy, smooth) {\n          if (!smooth) {\n            return moveBy(dx, dy);\n          }\n\n          if (moveByAnimation) moveByAnimation.cancel();\n          var from = {\n            x: 0,\n            y: 0\n          };\n          var to = {\n            x: dx,\n            y: dy\n          };\n          var lastX = 0;\n          var lastY = 0;\n          moveByAnimation = animate(from, to, {\n            step: function (v) {\n              moveBy(v.x - lastX, v.y - lastY);\n              lastX = v.x;\n              lastY = v.y;\n            }\n          });\n        }\n\n        function scroll(x, y) {\n          cancelZoomAnimation();\n          moveTo(x, y);\n        }\n\n        function dispose() {\n          releaseEvents();\n        }\n\n        function listenForEvents() {\n          owner.addEventListener('mousedown', onMouseDown, {\n            passive: false\n          });\n          owner.addEventListener('dblclick', onDoubleClick, {\n            passive: false\n          });\n          owner.addEventListener('touchstart', onTouch, {\n            passive: false\n          });\n          owner.addEventListener('keydown', onKeyDown, {\n            passive: false\n          }); // Need to listen on the owner container, so that we are not limited\n          // by the size of the scrollable domElement\n\n          wheel.addWheelListener(owner, onMouseWheel, {\n            passive: false\n          });\n          makeDirty();\n        }\n\n        function releaseEvents() {\n          wheel.removeWheelListener(owner, onMouseWheel);\n          owner.removeEventListener('mousedown', onMouseDown);\n          owner.removeEventListener('keydown', onKeyDown);\n          owner.removeEventListener('dblclick', onDoubleClick);\n          owner.removeEventListener('touchstart', onTouch);\n\n          if (frameAnimation) {\n            window.cancelAnimationFrame(frameAnimation);\n            frameAnimation = 0;\n          }\n\n          smoothScroll.cancel();\n          releaseDocumentMouse();\n          releaseTouches();\n          textSelection.release();\n          triggerPanEnd();\n        }\n\n        function frame() {\n          if (isDirty) applyTransform();\n        }\n\n        function applyTransform() {\n          isDirty = false; // TODO: Should I allow to cancel this?\n\n          panController.applyTransform(transform);\n          triggerEvent('transform');\n          frameAnimation = 0;\n        }\n\n        function onKeyDown(e) {\n          var x = 0,\n              y = 0,\n              z = 0;\n\n          if (e.keyCode === 38) {\n            y = 1; // up\n          } else if (e.keyCode === 40) {\n            y = -1; // down\n          } else if (e.keyCode === 37) {\n            x = 1; // left\n          } else if (e.keyCode === 39) {\n            x = -1; // right\n          } else if (e.keyCode === 189 || e.keyCode === 109) {\n            // DASH or SUBTRACT\n            z = 1; // `-` -  zoom out\n          } else if (e.keyCode === 187 || e.keyCode === 107) {\n            // EQUAL SIGN or ADD\n            z = -1; // `=` - zoom in (equal sign on US layout is under `+`)\n          }\n\n          if (filterKey(e, x, y, z)) {\n            // They don't want us to handle the key: https://github.com/anvaka/panzoom/issues/45\n            return;\n          }\n\n          if (x || y) {\n            e.preventDefault();\n            e.stopPropagation();\n            var clientRect = owner.getBoundingClientRect(); // movement speed should be the same in both X and Y direction:\n\n            var offset = Math.min(clientRect.width, clientRect.height);\n            var moveSpeedRatio = 0.05;\n            var dx = offset * moveSpeedRatio * x;\n            var dy = offset * moveSpeedRatio * y; // TODO: currently we do not animate this. It could be better to have animation\n\n            internalMoveBy(dx, dy);\n          }\n\n          if (z) {\n            var scaleMultiplier = getScaleMultiplier(z * 100);\n            var offset = transformOrigin ? getTransformOriginOffset() : midPoint();\n            publicZoomTo(offset.x, offset.y, scaleMultiplier);\n          }\n        }\n\n        function midPoint() {\n          var ownerRect = owner.getBoundingClientRect();\n          return {\n            x: ownerRect.width / 2,\n            y: ownerRect.height / 2\n          };\n        }\n\n        function onTouch(e) {\n          // let the override the touch behavior\n          beforeTouch(e);\n\n          if (e.touches.length === 1) {\n            return handleSingleFingerTouch(e, e.touches[0]);\n          } else if (e.touches.length === 2) {\n            // handleTouchMove() will care about pinch zoom.\n            pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n            multiTouch = true;\n            startTouchListenerIfNeeded();\n          }\n        }\n\n        function beforeTouch(e) {\n          // TODO: Need to unify this filtering names. E.g. use `beforeTouch`\n          if (options.onTouch && !options.onTouch(e)) {\n            // if they return `false` from onTouch, we don't want to stop\n            // events propagation. Fixes https://github.com/anvaka/panzoom/issues/12\n            return;\n          }\n\n          e.stopPropagation();\n          e.preventDefault();\n        }\n\n        function beforeDoubleClick(e) {\n          // TODO: Need to unify this filtering names. E.g. use `beforeDoubleClick``\n          if (options.onDoubleClick && !options.onDoubleClick(e)) {\n            // if they return `false` from onTouch, we don't want to stop\n            // events propagation. Fixes https://github.com/anvaka/panzoom/issues/46\n            return;\n          }\n\n          e.preventDefault();\n          e.stopPropagation();\n        }\n\n        function handleSingleFingerTouch(e) {\n          var touch = e.touches[0];\n          var offset = getOffsetXY(touch);\n          lastSingleFingerOffset = offset;\n          var point = transformToScreen(offset.x, offset.y);\n          mouseX = point.x;\n          mouseY = point.y;\n          smoothScroll.cancel();\n          startTouchListenerIfNeeded();\n        }\n\n        function startTouchListenerIfNeeded() {\n          if (touchInProgress) {\n            // no need to do anything, as we already listen to events;\n            return;\n          }\n\n          touchInProgress = true;\n          document.addEventListener('touchmove', handleTouchMove);\n          document.addEventListener('touchend', handleTouchEnd);\n          document.addEventListener('touchcancel', handleTouchEnd);\n        }\n\n        function handleTouchMove(e) {\n          if (e.touches.length === 1) {\n            e.stopPropagation();\n            var touch = e.touches[0];\n            var offset = getOffsetXY(touch);\n            var point = transformToScreen(offset.x, offset.y);\n            var dx = point.x - mouseX;\n            var dy = point.y - mouseY;\n\n            if (dx !== 0 && dy !== 0) {\n              triggerPanStart();\n            }\n\n            mouseX = point.x;\n            mouseY = point.y;\n            internalMoveBy(dx, dy);\n          } else if (e.touches.length === 2) {\n            // it's a zoom, let's find direction\n            multiTouch = true;\n            var t1 = e.touches[0];\n            var t2 = e.touches[1];\n            var currentPinchLength = getPinchZoomLength(t1, t2); // since the zoom speed is always based on distance from 1, we need to apply\n            // pinch speed only on that distance from 1:\n\n            var scaleMultiplier = 1 + (currentPinchLength / pinchZoomLength - 1) * pinchSpeed;\n            var firstTouchPoint = getOffsetXY(t1);\n            var secondTouchPoint = getOffsetXY(t2);\n            mouseX = (firstTouchPoint.x + secondTouchPoint.x) / 2;\n            mouseY = (firstTouchPoint.y + secondTouchPoint.y) / 2;\n\n            if (transformOrigin) {\n              var offset = getTransformOriginOffset();\n              mouseX = offset.x;\n              mouseY = offset.y;\n            }\n\n            publicZoomTo(mouseX, mouseY, scaleMultiplier);\n            pinchZoomLength = currentPinchLength;\n            e.stopPropagation();\n            e.preventDefault();\n          }\n        }\n\n        function handleTouchEnd(e) {\n          if (e.touches.length > 0) {\n            var offset = getOffsetXY(e.touches[0]);\n            var point = transformToScreen(offset.x, offset.y);\n            mouseX = point.x;\n            mouseY = point.y;\n          } else {\n            var now = new Date();\n\n            if (now - lastTouchEndTime < doubleTapSpeedInMS) {\n              if (transformOrigin) {\n                var offset = getTransformOriginOffset();\n                smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n              } else {\n                // We want untransformed x/y here.\n                smoothZoom(lastSingleFingerOffset.x, lastSingleFingerOffset.y, zoomDoubleClickSpeed);\n              }\n            }\n\n            lastTouchEndTime = now;\n            triggerPanEnd();\n            releaseTouches();\n          }\n        }\n\n        function getPinchZoomLength(finger1, finger2) {\n          var dx = finger1.clientX - finger2.clientX;\n          var dy = finger1.clientY - finger2.clientY;\n          return Math.sqrt(dx * dx + dy * dy);\n        }\n\n        function onDoubleClick(e) {\n          beforeDoubleClick(e);\n          var offset = getOffsetXY(e);\n\n          if (transformOrigin) {\n            // TODO: looks like this is duplicated in the file.\n            // Need to refactor\n            offset = getTransformOriginOffset();\n          }\n\n          smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n        }\n\n        function onMouseDown(e) {\n          // if client does not want to handle this event - just ignore the call\n          if (beforeMouseDown(e)) return;\n\n          if (touchInProgress) {\n            // modern browsers will fire mousedown for touch events too\n            // we do not want this: touch is handled separately.\n            e.stopPropagation();\n            return false;\n          } // for IE, left click == 1\n          // for Firefox, left click == 0\n\n\n          var isLeftButton = e.button === 1 && window.event !== null || e.button === 0;\n          if (!isLeftButton) return;\n          smoothScroll.cancel();\n          var offset = getOffsetXY(e);\n          var point = transformToScreen(offset.x, offset.y);\n          mouseX = point.x;\n          mouseY = point.y; // We need to listen on document itself, since mouse can go outside of the\n          // window, and we will loose it\n\n          document.addEventListener('mousemove', onMouseMove);\n          document.addEventListener('mouseup', onMouseUp);\n          textSelection.capture(e.target || e.srcElement);\n          return false;\n        }\n\n        function onMouseMove(e) {\n          // no need to worry about mouse events when touch is happening\n          if (touchInProgress) return;\n          triggerPanStart();\n          var offset = getOffsetXY(e);\n          var point = transformToScreen(offset.x, offset.y);\n          var dx = point.x - mouseX;\n          var dy = point.y - mouseY;\n          mouseX = point.x;\n          mouseY = point.y;\n          internalMoveBy(dx, dy);\n        }\n\n        function onMouseUp() {\n          textSelection.release();\n          triggerPanEnd();\n          releaseDocumentMouse();\n        }\n\n        function releaseDocumentMouse() {\n          document.removeEventListener('mousemove', onMouseMove);\n          document.removeEventListener('mouseup', onMouseUp);\n          panstartFired = false;\n        }\n\n        function releaseTouches() {\n          document.removeEventListener('touchmove', handleTouchMove);\n          document.removeEventListener('touchend', handleTouchEnd);\n          document.removeEventListener('touchcancel', handleTouchEnd);\n          panstartFired = false;\n          multiTouch = false;\n          touchInProgress = false;\n        }\n\n        function onMouseWheel(e) {\n          // if client does not want to handle this event - just ignore the call\n          if (beforeWheel(e)) return;\n          smoothScroll.cancel();\n          var delta = e.deltaY;\n          if (e.deltaMode > 0) delta *= 100;\n          var scaleMultiplier = getScaleMultiplier(delta);\n\n          if (scaleMultiplier !== 1) {\n            var offset = transformOrigin ? getTransformOriginOffset() : getOffsetXY(e);\n            publicZoomTo(offset.x, offset.y, scaleMultiplier);\n            e.preventDefault();\n          }\n        }\n\n        function getOffsetXY(e) {\n          var offsetX, offsetY; // I tried using e.offsetX, but that gives wrong results for svg, when user clicks on a path.\n\n          var ownerRect = owner.getBoundingClientRect();\n          offsetX = e.clientX - ownerRect.left;\n          offsetY = e.clientY - ownerRect.top;\n          return {\n            x: offsetX,\n            y: offsetY\n          };\n        }\n\n        function smoothZoom(clientX, clientY, scaleMultiplier) {\n          var fromValue = transform.scale;\n          var from = {\n            scale: fromValue\n          };\n          var to = {\n            scale: scaleMultiplier * fromValue\n          };\n          smoothScroll.cancel();\n          cancelZoomAnimation();\n          zoomToAnimation = animate(from, to, {\n            step: function (v) {\n              zoomAbs(clientX, clientY, v.scale);\n            },\n            done: triggerZoomEnd\n          });\n        }\n\n        function smoothZoomAbs(clientX, clientY, toScaleValue) {\n          var fromValue = transform.scale;\n          var from = {\n            scale: fromValue\n          };\n          var to = {\n            scale: toScaleValue\n          };\n          smoothScroll.cancel();\n          cancelZoomAnimation();\n          zoomToAnimation = animate(from, to, {\n            step: function (v) {\n              zoomAbs(clientX, clientY, v.scale);\n            }\n          });\n        }\n\n        function getTransformOriginOffset() {\n          var ownerRect = owner.getBoundingClientRect();\n          return {\n            x: ownerRect.width * transformOrigin.x,\n            y: ownerRect.height * transformOrigin.y\n          };\n        }\n\n        function publicZoomTo(clientX, clientY, scaleMultiplier) {\n          smoothScroll.cancel();\n          cancelZoomAnimation();\n          return zoomByRatio(clientX, clientY, scaleMultiplier);\n        }\n\n        function cancelZoomAnimation() {\n          if (zoomToAnimation) {\n            zoomToAnimation.cancel();\n            zoomToAnimation = null;\n          }\n        }\n\n        function getScaleMultiplier(delta) {\n          var sign = Math.sign(delta);\n          var deltaAdjustedSpeed = Math.min(0.25, Math.abs(speed * delta / 128));\n          return 1 - sign * deltaAdjustedSpeed;\n        }\n\n        function triggerPanStart() {\n          if (!panstartFired) {\n            triggerEvent('panstart');\n            panstartFired = true;\n            smoothScroll.start();\n          }\n        }\n\n        function triggerPanEnd() {\n          if (panstartFired) {\n            // we should never run smooth scrolling if it was multiTouch (pinch zoom animation):\n            if (!multiTouch) smoothScroll.stop();\n            triggerEvent('panend');\n          }\n        }\n\n        function triggerZoomEnd() {\n          triggerEvent('zoomend');\n        }\n\n        function triggerEvent(name) {\n          api.fire(name, api);\n        }\n      }\n\n      function parseTransformOrigin(options) {\n        if (!options) return;\n\n        if (typeof options === 'object') {\n          if (!isNumber(options.x) || !isNumber(options.y)) failTransformOrigin(options);\n          return options;\n        }\n\n        failTransformOrigin();\n      }\n\n      function failTransformOrigin(options) {\n        console.error(options);\n        throw new Error(['Cannot parse transform origin.', 'Some good examples:', '  \"center center\" can be achieved with {x: 0.5, y: 0.5}', '  \"top center\" can be achieved with {x: 0.5, y: 0}', '  \"bottom right\" can be achieved with {x: 1, y: 1}'].join('\\n'));\n      }\n\n      function noop() {}\n\n      function validateBounds(bounds) {\n        var boundsType = typeof bounds;\n        if (boundsType === 'undefined' || boundsType === 'boolean') return; // this is okay\n        // otherwise need to be more thorough:\n\n        var validBounds = isNumber(bounds.left) && isNumber(bounds.top) && isNumber(bounds.bottom) && isNumber(bounds.right);\n        if (!validBounds) throw new Error('Bounds object is not valid. It can be: ' + 'undefined, boolean (true|false) or an object {left, top, right, bottom}');\n      }\n\n      function isNumber(x) {\n        return Number.isFinite(x);\n      } // IE 11 does not support isNaN:\n\n\n      function isNaN(value) {\n        if (Number.isNaN) {\n          return Number.isNaN(value);\n        }\n\n        return value !== value;\n      }\n\n      function rigidScroll() {\n        return {\n          start: noop,\n          stop: noop,\n          cancel: noop\n        };\n      }\n\n      function autoRun() {\n        if (typeof document === 'undefined') return;\n        var scripts = document.getElementsByTagName('script');\n        if (!scripts) return;\n        var panzoomScript;\n\n        for (var i = 0; i < scripts.length; ++i) {\n          var x = scripts[i];\n\n          if (x.src && x.src.match(/\\bpanzoom(\\.min)?\\.js/)) {\n            panzoomScript = x;\n            break;\n          }\n        }\n\n        if (!panzoomScript) return;\n        var query = panzoomScript.getAttribute('query');\n        if (!query) return;\n        var globalName = panzoomScript.getAttribute('name') || 'pz';\n        var started = Date.now();\n        tryAttach();\n\n        function tryAttach() {\n          var el = document.querySelector(query);\n\n          if (!el) {\n            var now = Date.now();\n            var elapsed = now - started;\n\n            if (elapsed < 2000) {\n              // Let's wait a bit\n              setTimeout(tryAttach, 100);\n              return;\n            } // If we don't attach within 2 seconds to the target element, consider it a failure\n\n\n            console.error('Cannot find the panzoom element', globalName);\n            return;\n          }\n\n          var options = collectOptions(panzoomScript);\n          console.log(options);\n          window[globalName] = createPanZoom(el, options);\n        }\n\n        function collectOptions(script) {\n          var attrs = script.attributes;\n          var options = {};\n\n          for (var j = 0; j < attrs.length; ++j) {\n            var attr = attrs[j];\n            var nameValue = getPanzoomAttributeNameValue(attr);\n\n            if (nameValue) {\n              options[nameValue.name] = nameValue.value;\n            }\n          }\n\n          return options;\n        }\n\n        function getPanzoomAttributeNameValue(attr) {\n          if (!attr.name) return;\n          var isPanZoomAttribute = attr.name[0] === 'p' && attr.name[1] === 'z' && attr.name[2] === '-';\n          if (!isPanZoomAttribute) return;\n          var name = attr.name.substr(3);\n          var value = JSON.parse(attr.value);\n          return {\n            name: name,\n            value: value\n          };\n        }\n      }\n\n      autoRun();\n    }, {\n      \"./lib/createTextSelectionInterceptor.js\": 2,\n      \"./lib/domController.js\": 3,\n      \"./lib/kinetic.js\": 4,\n      \"./lib/svgController.js\": 5,\n      \"./lib/transform.js\": 6,\n      \"amator\": 7,\n      \"ngraph.events\": 9,\n      \"wheel\": 10\n    }],\n    2: [function (require, module, exports) {\n      /**\n       * Disallows selecting text.\n       */\n      module.exports = createTextSelectionInterceptor;\n\n      function createTextSelectionInterceptor(useFake) {\n        if (useFake) {\n          return {\n            capture: noop,\n            release: noop\n          };\n        }\n\n        var dragObject;\n        var prevSelectStart;\n        var prevDragStart;\n        var wasCaptured = false;\n        return {\n          capture: capture,\n          release: release\n        };\n\n        function capture(domObject) {\n          wasCaptured = true;\n          prevSelectStart = window.document.onselectstart;\n          prevDragStart = window.document.ondragstart;\n          window.document.onselectstart = disabled;\n          dragObject = domObject;\n          dragObject.ondragstart = disabled;\n        }\n\n        function release() {\n          if (!wasCaptured) return;\n          wasCaptured = false;\n          window.document.onselectstart = prevSelectStart;\n          if (dragObject) dragObject.ondragstart = prevDragStart;\n        }\n      }\n\n      function disabled(e) {\n        e.stopPropagation();\n        return false;\n      }\n\n      function noop() {}\n    }, {}],\n    3: [function (require, module, exports) {\n      module.exports = makeDomController;\n      module.exports.canAttach = isDomElement;\n\n      function makeDomController(domElement, options) {\n        var elementValid = isDomElement(domElement);\n\n        if (!elementValid) {\n          throw new Error('panzoom requires DOM element to be attached to the DOM tree');\n        }\n\n        var owner = domElement.parentElement;\n        domElement.scrollTop = 0;\n\n        if (!options.disableKeyboardInteraction) {\n          owner.setAttribute('tabindex', 0);\n        }\n\n        var api = {\n          getBBox: getBBox,\n          getOwner: getOwner,\n          applyTransform: applyTransform\n        };\n        return api;\n\n        function getOwner() {\n          return owner;\n        }\n\n        function getBBox() {\n          // TODO: We should probably cache this?\n          return {\n            left: 0,\n            top: 0,\n            width: domElement.clientWidth,\n            height: domElement.clientHeight\n          };\n        }\n\n        function applyTransform(transform) {\n          // TODO: Should we cache this?\n          domElement.style.transformOrigin = '0 0 0';\n          domElement.style.transform = 'matrix(' + transform.scale + ', 0, 0, ' + transform.scale + ', ' + transform.x + ', ' + transform.y + ')';\n        }\n      }\n\n      function isDomElement(element) {\n        return element && element.parentElement && element.style;\n      }\n    }, {}],\n    4: [function (require, module, exports) {\n      /**\n       * Allows smooth kinetic scrolling of the surface\n       */\n      module.exports = kinetic;\n\n      function kinetic(getPoint, scroll, settings) {\n        if (typeof settings !== 'object') {\n          // setting could come as boolean, we should ignore it, and use an object.\n          settings = {};\n        }\n\n        var minVelocity = typeof settings.minVelocity === 'number' ? settings.minVelocity : 5;\n        var amplitude = typeof settings.amplitude === 'number' ? settings.amplitude : 0.25;\n        var cancelAnimationFrame = typeof settings.cancelAnimationFrame === 'function' ? settings.cancelAnimationFrame : getCancelAnimationFrame();\n        var requestAnimationFrame = typeof settings.requestAnimationFrame === 'function' ? settings.requestAnimationFrame : getRequestAnimationFrame();\n        var lastPoint;\n        var timestamp;\n        var timeConstant = 342;\n        var ticker;\n        var vx, targetX, ax;\n        var vy, targetY, ay;\n        var raf;\n        return {\n          start: start,\n          stop: stop,\n          cancel: dispose\n        };\n\n        function dispose() {\n          cancelAnimationFrame(ticker);\n          cancelAnimationFrame(raf);\n        }\n\n        function start() {\n          lastPoint = getPoint();\n          ax = ay = vx = vy = 0;\n          timestamp = new Date();\n          cancelAnimationFrame(ticker);\n          cancelAnimationFrame(raf); // we start polling the point position to accumulate velocity\n          // Once we stop(), we will use accumulated velocity to keep scrolling\n          // an object.\n\n          ticker = requestAnimationFrame(track);\n        }\n\n        function track() {\n          var now = Date.now();\n          var elapsed = now - timestamp;\n          timestamp = now;\n          var currentPoint = getPoint();\n          var dx = currentPoint.x - lastPoint.x;\n          var dy = currentPoint.y - lastPoint.y;\n          lastPoint = currentPoint;\n          var dt = 1000 / (1 + elapsed); // moving average\n\n          vx = 0.8 * dx * dt + 0.2 * vx;\n          vy = 0.8 * dy * dt + 0.2 * vy;\n          ticker = requestAnimationFrame(track);\n        }\n\n        function stop() {\n          cancelAnimationFrame(ticker);\n          cancelAnimationFrame(raf);\n          var currentPoint = getPoint();\n          targetX = currentPoint.x;\n          targetY = currentPoint.y;\n          timestamp = Date.now();\n\n          if (vx < -minVelocity || vx > minVelocity) {\n            ax = amplitude * vx;\n            targetX += ax;\n          }\n\n          if (vy < -minVelocity || vy > minVelocity) {\n            ay = amplitude * vy;\n            targetY += ay;\n          }\n\n          raf = requestAnimationFrame(autoScroll);\n        }\n\n        function autoScroll() {\n          var elapsed = Date.now() - timestamp;\n          var moving = false;\n          var dx = 0;\n          var dy = 0;\n\n          if (ax) {\n            dx = -ax * Math.exp(-elapsed / timeConstant);\n            if (dx > 0.5 || dx < -0.5) moving = true;else dx = ax = 0;\n          }\n\n          if (ay) {\n            dy = -ay * Math.exp(-elapsed / timeConstant);\n            if (dy > 0.5 || dy < -0.5) moving = true;else dy = ay = 0;\n          }\n\n          if (moving) {\n            scroll(targetX + dx, targetY + dy);\n            raf = requestAnimationFrame(autoScroll);\n          }\n        }\n      }\n\n      function getCancelAnimationFrame() {\n        if (typeof cancelAnimationFrame === 'function') return cancelAnimationFrame;\n        return clearTimeout;\n      }\n\n      function getRequestAnimationFrame() {\n        if (typeof requestAnimationFrame === 'function') return requestAnimationFrame;\n        return function (handler) {\n          return setTimeout(handler, 16);\n        };\n      }\n    }, {}],\n    5: [function (require, module, exports) {\n      module.exports = makeSvgController;\n      module.exports.canAttach = isSVGElement;\n\n      function makeSvgController(svgElement, options) {\n        if (!isSVGElement(svgElement)) {\n          throw new Error('svg element is required for svg.panzoom to work');\n        }\n\n        var owner = svgElement.ownerSVGElement;\n\n        if (!owner) {\n          throw new Error('Do not apply panzoom to the root <svg> element. ' + 'Use its child instead (e.g. <g></g>). ' + 'As of March 2016 only FireFox supported transform on the root element');\n        }\n\n        if (!options.disableKeyboardInteraction) {\n          owner.setAttribute('tabindex', 0);\n        }\n\n        var api = {\n          getBBox: getBBox,\n          getScreenCTM: getScreenCTM,\n          getOwner: getOwner,\n          applyTransform: applyTransform,\n          initTransform: initTransform\n        };\n        return api;\n\n        function getOwner() {\n          return owner;\n        }\n\n        function getBBox() {\n          var bbox = svgElement.getBBox();\n          return {\n            left: bbox.x,\n            top: bbox.y,\n            width: bbox.width,\n            height: bbox.height\n          };\n        }\n\n        function getScreenCTM() {\n          var ctm = owner.getCTM();\n\n          if (!ctm) {\n            // This is likely firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=873106\n            // The code below is not entirely correct, but still better than nothing\n            return owner.getScreenCTM();\n          }\n\n          return ctm;\n        }\n\n        function initTransform(transform) {\n          var screenCTM = svgElement.getCTM(); // The above line returns null on Firefox\n\n          if (screenCTM === null) {\n            screenCTM = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\").createSVGMatrix();\n          }\n\n          transform.x = screenCTM.e;\n          transform.y = screenCTM.f;\n          transform.scale = screenCTM.a;\n          owner.removeAttributeNS(null, 'viewBox');\n        }\n\n        function applyTransform(transform) {\n          svgElement.setAttribute('transform', 'matrix(' + transform.scale + ' 0 0 ' + transform.scale + ' ' + transform.x + ' ' + transform.y + ')');\n        }\n      }\n\n      function isSVGElement(element) {\n        return element && element.ownerSVGElement && element.getCTM;\n      }\n    }, {}],\n    6: [function (require, module, exports) {\n      module.exports = Transform;\n\n      function Transform() {\n        this.x = 0;\n        this.y = 0;\n        this.scale = 1;\n      }\n    }, {}],\n    7: [function (require, module, exports) {\n      var BezierEasing = require('bezier-easing'); // Predefined set of animations. Similar to CSS easing functions\n\n\n      var animations = {\n        ease: BezierEasing(0.25, 0.1, 0.25, 1),\n        easeIn: BezierEasing(0.42, 0, 1, 1),\n        easeOut: BezierEasing(0, 0, 0.58, 1),\n        easeInOut: BezierEasing(0.42, 0, 0.58, 1),\n        linear: BezierEasing(0, 0, 1, 1)\n      };\n      module.exports = animate;\n      module.exports.makeAggregateRaf = makeAggregateRaf;\n      module.exports.sharedScheduler = makeAggregateRaf();\n\n      function animate(source, target, options) {\n        var start = Object.create(null);\n        var diff = Object.create(null);\n        options = options || {}; // We let clients specify their own easing function\n\n        var easing = typeof options.easing === 'function' ? options.easing : animations[options.easing]; // if nothing is specified, default to ease (similar to CSS animations)\n\n        if (!easing) {\n          if (options.easing) {\n            console.warn('Unknown easing function in amator: ' + options.easing);\n          }\n\n          easing = animations.ease;\n        }\n\n        var step = typeof options.step === 'function' ? options.step : noop;\n        var done = typeof options.done === 'function' ? options.done : noop;\n        var scheduler = getScheduler(options.scheduler);\n        var keys = Object.keys(target);\n        keys.forEach(function (key) {\n          start[key] = source[key];\n          diff[key] = target[key] - source[key];\n        });\n        var durationInMs = typeof options.duration === 'number' ? options.duration : 400;\n        var durationInFrames = Math.max(1, durationInMs * 0.06); // 0.06 because 60 frames pers 1,000 ms\n\n        var previousAnimationId;\n        var frame = 0;\n        previousAnimationId = scheduler.next(loop);\n        return {\n          cancel: cancel\n        };\n\n        function cancel() {\n          scheduler.cancel(previousAnimationId);\n          previousAnimationId = 0;\n        }\n\n        function loop() {\n          var t = easing(frame / durationInFrames);\n          frame += 1;\n          setValues(t);\n\n          if (frame <= durationInFrames) {\n            previousAnimationId = scheduler.next(loop);\n            step(source);\n          } else {\n            previousAnimationId = 0;\n            setTimeout(function () {\n              done(source);\n            }, 0);\n          }\n        }\n\n        function setValues(t) {\n          keys.forEach(function (key) {\n            source[key] = diff[key] * t + start[key];\n          });\n        }\n      }\n\n      function noop() {}\n\n      function getScheduler(scheduler) {\n        if (!scheduler) {\n          var canRaf = typeof window !== 'undefined' && window.requestAnimationFrame;\n          return canRaf ? rafScheduler() : timeoutScheduler();\n        }\n\n        if (typeof scheduler.next !== 'function') throw new Error('Scheduler is supposed to have next(cb) function');\n        if (typeof scheduler.cancel !== 'function') throw new Error('Scheduler is supposed to have cancel(handle) function');\n        return scheduler;\n      }\n\n      function rafScheduler() {\n        return {\n          next: window.requestAnimationFrame.bind(window),\n          cancel: window.cancelAnimationFrame.bind(window)\n        };\n      }\n\n      function timeoutScheduler() {\n        return {\n          next: function (cb) {\n            return setTimeout(cb, 1000 / 60);\n          },\n          cancel: function (id) {\n            return clearTimeout(id);\n          }\n        };\n      }\n\n      function makeAggregateRaf() {\n        var frontBuffer = new Set();\n        var backBuffer = new Set();\n        var frameToken = 0;\n        return {\n          next: next,\n          cancel: next,\n          clearAll: clearAll\n        };\n\n        function clearAll() {\n          frontBuffer.clear();\n          backBuffer.clear();\n          cancelAnimationFrame(frameToken);\n          frameToken = 0;\n        }\n\n        function next(callback) {\n          backBuffer.add(callback);\n          renderNextFrame();\n        }\n\n        function renderNextFrame() {\n          if (!frameToken) frameToken = requestAnimationFrame(renderFrame);\n        }\n\n        function renderFrame() {\n          frameToken = 0;\n          var t = backBuffer;\n          backBuffer = frontBuffer;\n          frontBuffer = t;\n          frontBuffer.forEach(function (callback) {\n            callback();\n          });\n          frontBuffer.clear();\n        }\n\n        function cancel(callback) {\n          backBuffer.delete(callback);\n        }\n      }\n    }, {\n      \"bezier-easing\": 8\n    }],\n    8: [function (require, module, exports) {\n      /**\n       * https://github.com/gre/bezier-easing\n       * BezierEasing - use bezier curve for transition easing function\n       * by Gatan Renaudeau 2014 - 2015  MIT License\n       */\n      // These values are established by empiricism with tests (tradeoff: performance VS precision)\n      var NEWTON_ITERATIONS = 4;\n      var NEWTON_MIN_SLOPE = 0.001;\n      var SUBDIVISION_PRECISION = 0.0000001;\n      var SUBDIVISION_MAX_ITERATIONS = 10;\n      var kSplineTableSize = 11;\n      var kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n      var float32ArraySupported = typeof Float32Array === 'function';\n\n      function A(aA1, aA2) {\n        return 1.0 - 3.0 * aA2 + 3.0 * aA1;\n      }\n\n      function B(aA1, aA2) {\n        return 3.0 * aA2 - 6.0 * aA1;\n      }\n\n      function C(aA1) {\n        return 3.0 * aA1;\n      } // Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\n\n\n      function calcBezier(aT, aA1, aA2) {\n        return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT;\n      } // Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\n\n\n      function getSlope(aT, aA1, aA2) {\n        return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1);\n      }\n\n      function binarySubdivide(aX, aA, aB, mX1, mX2) {\n        var currentX,\n            currentT,\n            i = 0;\n\n        do {\n          currentT = aA + (aB - aA) / 2.0;\n          currentX = calcBezier(currentT, mX1, mX2) - aX;\n\n          if (currentX > 0.0) {\n            aB = currentT;\n          } else {\n            aA = currentT;\n          }\n        } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n\n        return currentT;\n      }\n\n      function newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n        for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n          var currentSlope = getSlope(aGuessT, mX1, mX2);\n\n          if (currentSlope === 0.0) {\n            return aGuessT;\n          }\n\n          var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n          aGuessT -= currentX / currentSlope;\n        }\n\n        return aGuessT;\n      }\n\n      function LinearEasing(x) {\n        return x;\n      }\n\n      module.exports = function bezier(mX1, mY1, mX2, mY2) {\n        if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\n          throw new Error('bezier x values must be in [0, 1] range');\n        }\n\n        if (mX1 === mY1 && mX2 === mY2) {\n          return LinearEasing;\n        } // Precompute samples table\n\n\n        var sampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n\n        for (var i = 0; i < kSplineTableSize; ++i) {\n          sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n        }\n\n        function getTForX(aX) {\n          var intervalStart = 0.0;\n          var currentSample = 1;\n          var lastSample = kSplineTableSize - 1;\n\n          for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n            intervalStart += kSampleStepSize;\n          }\n\n          --currentSample; // Interpolate to provide an initial guess for t\n\n          var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n          var guessForT = intervalStart + dist * kSampleStepSize;\n          var initialSlope = getSlope(guessForT, mX1, mX2);\n\n          if (initialSlope >= NEWTON_MIN_SLOPE) {\n            return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n          } else if (initialSlope === 0.0) {\n            return guessForT;\n          } else {\n            return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n          }\n        }\n\n        return function BezierEasing(x) {\n          // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n          if (x === 0) {\n            return 0;\n          }\n\n          if (x === 1) {\n            return 1;\n          }\n\n          return calcBezier(getTForX(x), mY1, mY2);\n        };\n      };\n    }, {}],\n    9: [function (require, module, exports) {\n      module.exports = function eventify(subject) {\n        validateSubject(subject);\n        var eventsStorage = createEventsStorage(subject);\n        subject.on = eventsStorage.on;\n        subject.off = eventsStorage.off;\n        subject.fire = eventsStorage.fire;\n        return subject;\n      };\n\n      function createEventsStorage(subject) {\n        // Store all event listeners to this hash. Key is event name, value is array\n        // of callback records.\n        //\n        // A callback record consists of callback function and its optional context:\n        // { 'eventName' => [{callback: function, ctx: object}] }\n        var registeredEvents = Object.create(null);\n        return {\n          on: function (eventName, callback, ctx) {\n            if (typeof callback !== 'function') {\n              throw new Error('callback is expected to be a function');\n            }\n\n            var handlers = registeredEvents[eventName];\n\n            if (!handlers) {\n              handlers = registeredEvents[eventName] = [];\n            }\n\n            handlers.push({\n              callback: callback,\n              ctx: ctx\n            });\n            return subject;\n          },\n          off: function (eventName, callback) {\n            var wantToRemoveAll = typeof eventName === 'undefined';\n\n            if (wantToRemoveAll) {\n              // Killing old events storage should be enough in this case:\n              registeredEvents = Object.create(null);\n              return subject;\n            }\n\n            if (registeredEvents[eventName]) {\n              var deleteAllCallbacksForEvent = typeof callback !== 'function';\n\n              if (deleteAllCallbacksForEvent) {\n                delete registeredEvents[eventName];\n              } else {\n                var callbacks = registeredEvents[eventName];\n\n                for (var i = 0; i < callbacks.length; ++i) {\n                  if (callbacks[i].callback === callback) {\n                    callbacks.splice(i, 1);\n                  }\n                }\n              }\n            }\n\n            return subject;\n          },\n          fire: function (eventName) {\n            var callbacks = registeredEvents[eventName];\n\n            if (!callbacks) {\n              return subject;\n            }\n\n            var fireArguments;\n\n            if (arguments.length > 1) {\n              fireArguments = Array.prototype.splice.call(arguments, 1);\n            }\n\n            for (var i = 0; i < callbacks.length; ++i) {\n              var callbackInfo = callbacks[i];\n              callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n            }\n\n            return subject;\n          }\n        };\n      }\n\n      function validateSubject(subject) {\n        if (!subject) {\n          throw new Error('Eventify cannot use falsy object as events subject');\n        }\n\n        var reservedWords = ['on', 'fire', 'off'];\n\n        for (var i = 0; i < reservedWords.length; ++i) {\n          if (subject.hasOwnProperty(reservedWords[i])) {\n            throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n          }\n        }\n      }\n    }, {}],\n    10: [function (require, module, exports) {\n      /**\n       * This module used to unify mouse wheel behavior between different browsers in 2014\n       * Now it's just a wrapper around addEventListener('wheel');\n       *\n       * Usage:\n       *  var addWheelListener = require('wheel').addWheelListener;\n       *  var removeWheelListener = require('wheel').removeWheelListener;\n       *  addWheelListener(domElement, function (e) {\n       *    // mouse wheel event\n       *  });\n       *  removeWheelListener(domElement, function);\n       */\n      module.exports = addWheelListener; // But also expose \"advanced\" api with unsubscribe:\n\n      module.exports.addWheelListener = addWheelListener;\n      module.exports.removeWheelListener = removeWheelListener;\n\n      function addWheelListener(element, listener, useCapture) {\n        element.addEventListener('wheel', listener, useCapture);\n      }\n\n      function removeWheelListener(element, listener, useCapture) {\n        element.removeEventListener('wheel', listener, useCapture);\n      }\n    }, {}]\n  }, {}, [1])(1);\n});","map":{"version":3,"sources":["/mnt/5ef62a2a-1eec-4bdc-ad7c-f8a7d48861b1/Nextcloud/Dokumente/Coding/Projects/www/russiantrade/webapp/webpage/node_modules/panzoom/dist/panzoom.js"],"names":["f","exports","module","define","amd","g","window","global","self","panzoom","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","wheel","animate","eventify","kinetic","createTextSelectionInterceptor","domTextSelectionInterceptor","fakeTextSelectorInterceptor","Transform","makeSvgController","makeDomController","defaultZoomSpeed","defaultDoubleTapZoomSpeed","doubleTapSpeedInMS","createPanZoom","domElement","options","panController","controller","canAttach","owner","getOwner","storedCTMResult","x","y","isDirty","transform","initTransform","filterKey","noop","pinchSpeed","bounds","maxZoom","Number","POSITIVE_INFINITY","minZoom","boundsPadding","zoomDoubleClickSpeed","beforeWheel","beforeMouseDown","speed","zoomSpeed","transformOrigin","parseTransformOrigin","textSelection","enableTextSelection","validateBounds","autocenter","frameAnimation","lastTouchEndTime","lastSingleFingerOffset","touchInProgress","panstartFired","mouseX","mouseY","pinchZoomLength","smoothScroll","rigidScroll","getPoint","scroll","moveByAnimation","zoomToAnimation","multiTouch","paused","listenForEvents","api","dispose","moveBy","internalMoveBy","moveTo","smoothMoveTo","centerOn","zoomTo","publicZoomTo","zoomAbs","smoothZoom","smoothZoomAbs","showRectangle","pause","resume","isPaused","getTransform","getTransformModel","getMinZoom","setMinZoom","getMaxZoom","setMaxZoom","getTransformOrigin","setTransformOrigin","getZoomSpeed","setZoomSpeed","initialX","initialY","initialZoom","scale","releaseEvents","rect","clientRect","getBoundingClientRect","size","transformToScreen","width","height","rectWidth","right","left","rectHeight","bottom","top","isFinite","dw","dh","Math","min","getScreenCTM","parentCTM","parentScaleX","parentScaleY","d","parentOffsetX","parentOffsetY","w","h","sceneBoundingBox","getBoundingBox","ownerRect","bbox","getBBox","newMinZoom","newMaxZoom","newTransformOrigin","newSpeed","keepTransformInsideBounds","triggerEvent","makeDirty","dx","dy","boundingBox","adjusted","getClientRect","diff","sceneWidth","sceneHeight","leftTop","client","requestAnimationFrame","frame","zoomByRatio","clientX","clientY","ratio","isNaN","newScale","transformAdjusted","zoomLevel","ui","parent","ownerSVGElement","cx","cy","container","smooth","cancel","from","to","lastX","lastY","step","v","cancelZoomAnimation","addEventListener","onMouseDown","passive","onDoubleClick","onTouch","onKeyDown","addWheelListener","onMouseWheel","removeWheelListener","removeEventListener","cancelAnimationFrame","releaseDocumentMouse","releaseTouches","release","triggerPanEnd","applyTransform","z","keyCode","preventDefault","stopPropagation","offset","moveSpeedRatio","scaleMultiplier","getScaleMultiplier","getTransformOriginOffset","midPoint","beforeTouch","touches","handleSingleFingerTouch","getPinchZoomLength","startTouchListenerIfNeeded","beforeDoubleClick","touch","getOffsetXY","point","document","handleTouchMove","handleTouchEnd","triggerPanStart","t1","t2","currentPinchLength","firstTouchPoint","secondTouchPoint","now","Date","finger1","finger2","sqrt","isLeftButton","button","event","onMouseMove","onMouseUp","capture","target","srcElement","delta","deltaY","deltaMode","offsetX","offsetY","fromValue","done","triggerZoomEnd","toScaleValue","sign","deltaAdjustedSpeed","abs","start","stop","name","fire","isNumber","failTransformOrigin","console","error","join","boundsType","validBounds","value","autoRun","scripts","getElementsByTagName","panzoomScript","src","match","query","getAttribute","globalName","started","tryAttach","el","querySelector","elapsed","setTimeout","collectOptions","log","script","attrs","attributes","j","attr","nameValue","getPanzoomAttributeNameValue","isPanZoomAttribute","substr","JSON","parse","useFake","dragObject","prevSelectStart","prevDragStart","wasCaptured","domObject","onselectstart","ondragstart","disabled","isDomElement","elementValid","parentElement","scrollTop","disableKeyboardInteraction","setAttribute","clientWidth","clientHeight","style","element","settings","minVelocity","amplitude","getCancelAnimationFrame","getRequestAnimationFrame","lastPoint","timestamp","timeConstant","ticker","vx","targetX","ax","vy","targetY","ay","raf","track","currentPoint","dt","autoScroll","moving","exp","clearTimeout","handler","isSVGElement","svgElement","ctm","getCTM","screenCTM","createElementNS","createSVGMatrix","removeAttributeNS","BezierEasing","animations","ease","easeIn","easeOut","easeInOut","linear","makeAggregateRaf","sharedScheduler","source","Object","create","easing","warn","scheduler","getScheduler","keys","forEach","key","durationInMs","duration","durationInFrames","max","previousAnimationId","next","loop","setValues","canRaf","rafScheduler","timeoutScheduler","bind","cb","id","frontBuffer","Set","backBuffer","frameToken","clearAll","clear","callback","add","renderNextFrame","renderFrame","delete","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","Float32Array","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","newtonRaphsonIterate","aGuessT","currentSlope","LinearEasing","bezier","mY1","mY2","sampleValues","Array","getTForX","intervalStart","currentSample","lastSample","dist","guessForT","initialSlope","subject","validateSubject","eventsStorage","createEventsStorage","on","off","registeredEvents","eventName","ctx","handlers","push","wantToRemoveAll","deleteAllCallbacksForEvent","callbacks","splice","fireArguments","arguments","prototype","callbackInfo","apply","reservedWords","hasOwnProperty","listener","useCapture"],"mappings":"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","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.panzoom = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n/**\n * Allows to drag and zoom svg elements\n */\nvar wheel = require('wheel');\nvar animate = require('amator');\nvar eventify = require('ngraph.events');\nvar kinetic = require('./lib/kinetic.js');\nvar createTextSelectionInterceptor = require('./lib/createTextSelectionInterceptor.js');\nvar domTextSelectionInterceptor = createTextSelectionInterceptor();\nvar fakeTextSelectorInterceptor = createTextSelectionInterceptor(true);\nvar Transform = require('./lib/transform.js');\nvar makeSvgController = require('./lib/svgController.js');\nvar makeDomController = require('./lib/domController.js');\n\nvar defaultZoomSpeed = 1;\nvar defaultDoubleTapZoomSpeed = 1.75;\nvar doubleTapSpeedInMS = 300;\n\nmodule.exports = createPanZoom;\n\n/**\n * Creates a new instance of panzoom, so that an object can be panned and zoomed\n *\n * @param {DOMElement} domElement where panzoom should be attached.\n * @param {Object} options that configure behavior.\n */\nfunction createPanZoom(domElement, options) {\n  options = options || {};\n\n  var panController = options.controller;\n\n  if (!panController) {\n    if (makeSvgController.canAttach(domElement)) {\n      panController = makeSvgController(domElement, options);\n    } else if (makeDomController.canAttach(domElement)) {\n      panController = makeDomController(domElement, options);\n    }\n  }\n\n  if (!panController) {\n    throw new Error(\n      'Cannot create panzoom for the current type of dom element'\n    );\n  }\n  var owner = panController.getOwner();\n  // just to avoid GC pressure, every time we do intermediate transform\n  // we return this object. For internal use only. Never give it back to the consumer of this library\n  var storedCTMResult = { x: 0, y: 0 };\n\n  var isDirty = false;\n  var transform = new Transform();\n\n  if (panController.initTransform) {\n    panController.initTransform(transform);\n  }\n\n  var filterKey = typeof options.filterKey === 'function' ? options.filterKey : noop;\n  // TODO: likely need to unite pinchSpeed with zoomSpeed\n  var pinchSpeed = typeof options.pinchSpeed === 'number' ? options.pinchSpeed : 1;\n  var bounds = options.bounds;\n  var maxZoom = typeof options.maxZoom === 'number' ? options.maxZoom : Number.POSITIVE_INFINITY;\n  var minZoom = typeof options.minZoom === 'number' ? options.minZoom : 0;\n\n  var boundsPadding = typeof options.boundsPadding === 'number' ? options.boundsPadding : 0.05;\n  var zoomDoubleClickSpeed = typeof options.zoomDoubleClickSpeed === 'number' ? options.zoomDoubleClickSpeed : defaultDoubleTapZoomSpeed;\n  var beforeWheel = options.beforeWheel || noop;\n  var beforeMouseDown = options.beforeMouseDown || noop;\n  var speed = typeof options.zoomSpeed === 'number' ? options.zoomSpeed : defaultZoomSpeed;\n  var transformOrigin = parseTransformOrigin(options.transformOrigin);\n  var textSelection = options.enableTextSelection ? fakeTextSelectorInterceptor : domTextSelectionInterceptor;\n\n  validateBounds(bounds);\n\n  if (options.autocenter) {\n    autocenter();\n  }\n\n  var frameAnimation;\n  var lastTouchEndTime = 0;\n  var lastSingleFingerOffset;\n  var touchInProgress = false;\n\n  // We only need to fire panstart when actual move happens\n  var panstartFired = false;\n\n  // cache mouse coordinates here\n  var mouseX;\n  var mouseY;\n\n  var pinchZoomLength;\n\n  var smoothScroll;\n  if ('smoothScroll' in options && !options.smoothScroll) {\n    // If user explicitly asked us not to use smooth scrolling, we obey\n    smoothScroll = rigidScroll();\n  } else {\n    // otherwise we use forward smoothScroll settings to kinetic API\n    // which makes scroll smoothing.\n    smoothScroll = kinetic(getPoint, scroll, options.smoothScroll);\n  }\n\n  var moveByAnimation;\n  var zoomToAnimation;\n\n  var multiTouch;\n  var paused = false;\n\n  listenForEvents();\n\n  var api = {\n    dispose: dispose,\n    moveBy: internalMoveBy,\n    moveTo: moveTo,\n    smoothMoveTo: smoothMoveTo, \n    centerOn: centerOn,\n    zoomTo: publicZoomTo,\n    zoomAbs: zoomAbs,\n    smoothZoom: smoothZoom,\n    smoothZoomAbs: smoothZoomAbs,\n    showRectangle: showRectangle,\n\n    pause: pause,\n    resume: resume,\n    isPaused: isPaused,\n\n    getTransform: getTransformModel,\n\n    getMinZoom: getMinZoom,\n    setMinZoom: setMinZoom,\n\n    getMaxZoom: getMaxZoom,\n    setMaxZoom: setMaxZoom,\n\n    getTransformOrigin: getTransformOrigin,\n    setTransformOrigin: setTransformOrigin,\n\n    getZoomSpeed: getZoomSpeed,\n    setZoomSpeed: setZoomSpeed\n  };\n\n  eventify(api);\n  \n  var initialX = typeof options.initialX === 'number' ? options.initialX : transform.x;\n  var initialY = typeof options.initialY === 'number' ? options.initialY : transform.y;\n  var initialZoom = typeof options.initialZoom === 'number' ? options.initialZoom : transform.scale;\n\n  if(initialX != transform.x || initialY != transform.y || initialZoom != transform.scale){\n    zoomAbs(initialX, initialY, initialZoom);\n  }\n\n  return api;\n\n  function pause() {\n    releaseEvents();\n    paused = true;\n  }\n\n  function resume() {\n    if (paused) {\n      listenForEvents();\n      paused = false;\n    }\n  }\n\n  function isPaused() {\n    return paused;\n  }\n\n  function showRectangle(rect) {\n    // TODO: this duplicates autocenter. I think autocenter should go.\n    var clientRect = owner.getBoundingClientRect();\n    var size = transformToScreen(clientRect.width, clientRect.height);\n\n    var rectWidth = rect.right - rect.left;\n    var rectHeight = rect.bottom - rect.top;\n    if (!Number.isFinite(rectWidth) || !Number.isFinite(rectHeight)) {\n      throw new Error('Invalid rectangle');\n    }\n\n    var dw = size.x / rectWidth;\n    var dh = size.y / rectHeight;\n    var scale = Math.min(dw, dh);\n    transform.x = -(rect.left + rectWidth / 2) * scale + size.x / 2;\n    transform.y = -(rect.top + rectHeight / 2) * scale + size.y / 2;\n    transform.scale = scale;\n  }\n\n  function transformToScreen(x, y) {\n    if (panController.getScreenCTM) {\n      var parentCTM = panController.getScreenCTM();\n      var parentScaleX = parentCTM.a;\n      var parentScaleY = parentCTM.d;\n      var parentOffsetX = parentCTM.e;\n      var parentOffsetY = parentCTM.f;\n      storedCTMResult.x = x * parentScaleX - parentOffsetX;\n      storedCTMResult.y = y * parentScaleY - parentOffsetY;\n    } else {\n      storedCTMResult.x = x;\n      storedCTMResult.y = y;\n    }\n\n    return storedCTMResult;\n  }\n\n  function autocenter() {\n    var w; // width of the parent\n    var h; // height of the parent\n    var left = 0;\n    var top = 0;\n    var sceneBoundingBox = getBoundingBox();\n    if (sceneBoundingBox) {\n      // If we have bounding box - use it.\n      left = sceneBoundingBox.left;\n      top = sceneBoundingBox.top;\n      w = sceneBoundingBox.right - sceneBoundingBox.left;\n      h = sceneBoundingBox.bottom - sceneBoundingBox.top;\n    } else {\n      // otherwise just use whatever space we have\n      var ownerRect = owner.getBoundingClientRect();\n      w = ownerRect.width;\n      h = ownerRect.height;\n    }\n    var bbox = panController.getBBox();\n    if (bbox.width === 0 || bbox.height === 0) {\n      // we probably do not have any elements in the SVG\n      // just bail out;\n      return;\n    }\n    var dh = h / bbox.height;\n    var dw = w / bbox.width;\n    var scale = Math.min(dw, dh);\n    transform.x = -(bbox.left + bbox.width / 2) * scale + w / 2 + left;\n    transform.y = -(bbox.top + bbox.height / 2) * scale + h / 2 + top;\n    transform.scale = scale;\n  }\n\n  function getTransformModel() {\n    // TODO: should this be read only?\n    return transform;\n  }\n\n  function getMinZoom() {\n    return minZoom;\n  }\n\n  function setMinZoom(newMinZoom) {\n    minZoom = newMinZoom;\n  }\n\n  function getMaxZoom() {\n    return maxZoom;\n  }\n\n  function setMaxZoom(newMaxZoom) {\n    maxZoom = newMaxZoom;\n  }\n\n  function getTransformOrigin() {\n    return transformOrigin;\n  }\n\n  function setTransformOrigin(newTransformOrigin) {\n    transformOrigin = parseTransformOrigin(newTransformOrigin);\n  }\n\n  function getZoomSpeed() {\n    return speed;\n  }\n\n  function setZoomSpeed(newSpeed) {\n    if (!Number.isFinite(newSpeed)) {\n      throw new Error('Zoom speed should be a number');\n    }\n    speed = newSpeed;\n  }\n\n  function getPoint() {\n    return {\n      x: transform.x,\n      y: transform.y\n    };\n  }\n\n  function moveTo(x, y) {\n    transform.x = x;\n    transform.y = y;\n\n    keepTransformInsideBounds();\n\n    triggerEvent('pan');\n    makeDirty();\n  }\n\n  function moveBy(dx, dy) {\n    moveTo(transform.x + dx, transform.y + dy);\n  }\n\n  function keepTransformInsideBounds() {\n    var boundingBox = getBoundingBox();\n    if (!boundingBox) return;\n\n    var adjusted = false;\n    var clientRect = getClientRect();\n\n    var diff = boundingBox.left - clientRect.right;\n    if (diff > 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n    // check the other side:\n    diff = boundingBox.right - clientRect.left;\n    if (diff < 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n\n    // y axis:\n    diff = boundingBox.top - clientRect.bottom;\n    if (diff > 0) {\n      // we adjust transform, so that it matches exactly our bounding box:\n      // transform.y = boundingBox.top - (boundingBox.height + boundingBox.y) * transform.scale =>\n      // transform.y = boundingBox.top - (clientRect.bottom - transform.y) =>\n      // transform.y = diff + transform.y =>\n      transform.y += diff;\n      adjusted = true;\n    }\n\n    diff = boundingBox.bottom - clientRect.top;\n    if (diff < 0) {\n      transform.y += diff;\n      adjusted = true;\n    }\n    return adjusted;\n  }\n\n  /**\n   * Returns bounding box that should be used to restrict scene movement.\n   */\n  function getBoundingBox() {\n    if (!bounds) return; // client does not want to restrict movement\n\n    if (typeof bounds === 'boolean') {\n      // for boolean type we use parent container bounds\n      var ownerRect = owner.getBoundingClientRect();\n      var sceneWidth = ownerRect.width;\n      var sceneHeight = ownerRect.height;\n\n      return {\n        left: sceneWidth * boundsPadding,\n        top: sceneHeight * boundsPadding,\n        right: sceneWidth * (1 - boundsPadding),\n        bottom: sceneHeight * (1 - boundsPadding)\n      };\n    }\n\n    return bounds;\n  }\n\n  function getClientRect() {\n    var bbox = panController.getBBox();\n    var leftTop = client(bbox.left, bbox.top);\n\n    return {\n      left: leftTop.x,\n      top: leftTop.y,\n      right: bbox.width * transform.scale + leftTop.x,\n      bottom: bbox.height * transform.scale + leftTop.y\n    };\n  }\n\n  function client(x, y) {\n    return {\n      x: x * transform.scale + transform.x,\n      y: y * transform.scale + transform.y\n    };\n  }\n\n  function makeDirty() {\n    isDirty = true;\n    frameAnimation = window.requestAnimationFrame(frame);\n  }\n\n  function zoomByRatio(clientX, clientY, ratio) {\n    if (isNaN(clientX) || isNaN(clientY) || isNaN(ratio)) {\n      throw new Error('zoom requires valid numbers');\n    }\n\n    var newScale = transform.scale * ratio;\n\n    if (newScale < minZoom) {\n      if (transform.scale === minZoom) return;\n\n      ratio = minZoom / transform.scale;\n    }\n    if (newScale > maxZoom) {\n      if (transform.scale === maxZoom) return;\n\n      ratio = maxZoom / transform.scale;\n    }\n\n    var size = transformToScreen(clientX, clientY);\n\n    transform.x = size.x - ratio * (size.x - transform.x);\n    transform.y = size.y - ratio * (size.y - transform.y);\n\n    // TODO: https://github.com/anvaka/panzoom/issues/112\n    if (bounds && boundsPadding === 1 && minZoom === 1) {\n      transform.scale *= ratio;\n      keepTransformInsideBounds();\n    } else {\n      var transformAdjusted = keepTransformInsideBounds();\n      if (!transformAdjusted) transform.scale *= ratio;\n    }\n\n    triggerEvent('zoom');\n\n    makeDirty();\n  }\n\n  function zoomAbs(clientX, clientY, zoomLevel) {\n    var ratio = zoomLevel / transform.scale;\n    zoomByRatio(clientX, clientY, ratio);\n  }\n\n  function centerOn(ui) {\n    var parent = ui.ownerSVGElement;\n    if (!parent)\n      throw new Error('ui element is required to be within the scene');\n\n    // TODO: should i use controller's screen CTM?\n    var clientRect = ui.getBoundingClientRect();\n    var cx = clientRect.left + clientRect.width / 2;\n    var cy = clientRect.top + clientRect.height / 2;\n\n    var container = parent.getBoundingClientRect();\n    var dx = container.width / 2 - cx;\n    var dy = container.height / 2 - cy;\n\n    internalMoveBy(dx, dy, true);\n  }\n\n  function smoothMoveTo(x, y){\n    internalMoveBy(x - transform.x, y - transform.y, true);\n  }\n\n  function internalMoveBy(dx, dy, smooth) {\n    if (!smooth) {\n      return moveBy(dx, dy);\n    }\n\n    if (moveByAnimation) moveByAnimation.cancel();\n\n    var from = { x: 0, y: 0 };\n    var to = { x: dx, y: dy };\n    var lastX = 0;\n    var lastY = 0;\n\n    moveByAnimation = animate(from, to, {\n      step: function (v) {\n        moveBy(v.x - lastX, v.y - lastY);\n\n        lastX = v.x;\n        lastY = v.y;\n      }\n    });\n  }\n\n  function scroll(x, y) {\n    cancelZoomAnimation();\n    moveTo(x, y);\n  }\n\n  function dispose() {\n    releaseEvents();\n  }\n\n  function listenForEvents() {\n    owner.addEventListener('mousedown', onMouseDown, { passive: false });\n    owner.addEventListener('dblclick', onDoubleClick, { passive: false });\n    owner.addEventListener('touchstart', onTouch, { passive: false });\n    owner.addEventListener('keydown', onKeyDown, { passive: false });\n\n    // Need to listen on the owner container, so that we are not limited\n    // by the size of the scrollable domElement\n    wheel.addWheelListener(owner, onMouseWheel, { passive: false });\n\n    makeDirty();\n  }\n\n  function releaseEvents() {\n    wheel.removeWheelListener(owner, onMouseWheel);\n    owner.removeEventListener('mousedown', onMouseDown);\n    owner.removeEventListener('keydown', onKeyDown);\n    owner.removeEventListener('dblclick', onDoubleClick);\n    owner.removeEventListener('touchstart', onTouch);\n\n    if (frameAnimation) {\n      window.cancelAnimationFrame(frameAnimation);\n      frameAnimation = 0;\n    }\n\n    smoothScroll.cancel();\n\n    releaseDocumentMouse();\n    releaseTouches();\n    textSelection.release();\n\n    triggerPanEnd();\n  }\n\n  function frame() {\n    if (isDirty) applyTransform();\n  }\n\n  function applyTransform() {\n    isDirty = false;\n\n    // TODO: Should I allow to cancel this?\n    panController.applyTransform(transform);\n\n    triggerEvent('transform');\n    frameAnimation = 0;\n  }\n\n  function onKeyDown(e) {\n    var x = 0,\n      y = 0,\n      z = 0;\n    if (e.keyCode === 38) {\n      y = 1; // up\n    } else if (e.keyCode === 40) {\n      y = -1; // down\n    } else if (e.keyCode === 37) {\n      x = 1; // left\n    } else if (e.keyCode === 39) {\n      x = -1; // right\n    } else if (e.keyCode === 189 || e.keyCode === 109) {\n      // DASH or SUBTRACT\n      z = 1; // `-` -  zoom out\n    } else if (e.keyCode === 187 || e.keyCode === 107) {\n      // EQUAL SIGN or ADD\n      z = -1; // `=` - zoom in (equal sign on US layout is under `+`)\n    }\n\n    if (filterKey(e, x, y, z)) {\n      // They don't want us to handle the key: https://github.com/anvaka/panzoom/issues/45\n      return;\n    }\n\n    if (x || y) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      var clientRect = owner.getBoundingClientRect();\n      // movement speed should be the same in both X and Y direction:\n      var offset = Math.min(clientRect.width, clientRect.height);\n      var moveSpeedRatio = 0.05;\n      var dx = offset * moveSpeedRatio * x;\n      var dy = offset * moveSpeedRatio * y;\n\n      // TODO: currently we do not animate this. It could be better to have animation\n      internalMoveBy(dx, dy);\n    }\n\n    if (z) {\n      var scaleMultiplier = getScaleMultiplier(z * 100);\n      var offset = transformOrigin ? getTransformOriginOffset() : midPoint();\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n    }\n  }\n\n  function midPoint() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width / 2,\n      y: ownerRect.height / 2\n    };\n  }\n\n  function onTouch(e) {\n    // let the override the touch behavior\n    beforeTouch(e);\n\n    if (e.touches.length === 1) {\n      return handleSingleFingerTouch(e, e.touches[0]);\n    } else if (e.touches.length === 2) {\n      // handleTouchMove() will care about pinch zoom.\n      pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n      multiTouch = true;\n      startTouchListenerIfNeeded();\n    }\n  }\n\n  function beforeTouch(e) {\n    // TODO: Need to unify this filtering names. E.g. use `beforeTouch`\n    if (options.onTouch && !options.onTouch(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/12\n      return;\n    }\n\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  function beforeDoubleClick(e) {\n    // TODO: Need to unify this filtering names. E.g. use `beforeDoubleClick``\n    if (options.onDoubleClick && !options.onDoubleClick(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/46\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  function handleSingleFingerTouch(e) {\n    var touch = e.touches[0];\n    var offset = getOffsetXY(touch);\n    lastSingleFingerOffset = offset;\n    var point = transformToScreen(offset.x, offset.y);\n    mouseX = point.x;\n    mouseY = point.y;\n\n    smoothScroll.cancel();\n    startTouchListenerIfNeeded();\n  }\n\n  function startTouchListenerIfNeeded() {\n    if (touchInProgress) {\n      // no need to do anything, as we already listen to events;\n      return;\n    }\n\n    touchInProgress = true;\n    document.addEventListener('touchmove', handleTouchMove);\n    document.addEventListener('touchend', handleTouchEnd);\n    document.addEventListener('touchcancel', handleTouchEnd);\n  }\n\n  function handleTouchMove(e) {\n    if (e.touches.length === 1) {\n      e.stopPropagation();\n      var touch = e.touches[0];\n\n      var offset = getOffsetXY(touch);\n      var point = transformToScreen(offset.x, offset.y);\n\n      var dx = point.x - mouseX;\n      var dy = point.y - mouseY;\n\n      if (dx !== 0 && dy !== 0) {\n        triggerPanStart();\n      }\n      mouseX = point.x;\n      mouseY = point.y;\n      internalMoveBy(dx, dy);\n    } else if (e.touches.length === 2) {\n      // it's a zoom, let's find direction\n      multiTouch = true;\n      var t1 = e.touches[0];\n      var t2 = e.touches[1];\n      var currentPinchLength = getPinchZoomLength(t1, t2);\n\n      // since the zoom speed is always based on distance from 1, we need to apply\n      // pinch speed only on that distance from 1:\n      var scaleMultiplier =\n        1 + (currentPinchLength / pinchZoomLength - 1) * pinchSpeed;\n\n      var firstTouchPoint = getOffsetXY(t1);\n      var secondTouchPoint = getOffsetXY(t2);\n      mouseX = (firstTouchPoint.x + secondTouchPoint.x) / 2;\n      mouseY = (firstTouchPoint.y + secondTouchPoint.y) / 2;\n      if (transformOrigin) {\n        var offset = getTransformOriginOffset();\n        mouseX = offset.x;\n        mouseY = offset.y;\n      }\n\n      publicZoomTo(mouseX, mouseY, scaleMultiplier);\n\n      pinchZoomLength = currentPinchLength;\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  function handleTouchEnd(e) {\n    if (e.touches.length > 0) {\n      var offset = getOffsetXY(e.touches[0]);\n      var point = transformToScreen(offset.x, offset.y);\n      mouseX = point.x;\n      mouseY = point.y;\n    } else {\n      var now = new Date();\n      if (now - lastTouchEndTime < doubleTapSpeedInMS) {\n        if (transformOrigin) {\n          var offset = getTransformOriginOffset();\n          smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n        } else {\n          // We want untransformed x/y here.\n          smoothZoom(lastSingleFingerOffset.x, lastSingleFingerOffset.y, zoomDoubleClickSpeed);\n        }\n      }\n\n      lastTouchEndTime = now;\n\n      triggerPanEnd();\n      releaseTouches();\n    }\n  }\n\n  function getPinchZoomLength(finger1, finger2) {\n    var dx = finger1.clientX - finger2.clientX;\n    var dy = finger1.clientY - finger2.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  function onDoubleClick(e) {\n    beforeDoubleClick(e);\n    var offset = getOffsetXY(e);\n    if (transformOrigin) {\n      // TODO: looks like this is duplicated in the file.\n      // Need to refactor\n      offset = getTransformOriginOffset();\n    }\n    smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n  }\n\n  function onMouseDown(e) {\n    // if client does not want to handle this event - just ignore the call\n    if (beforeMouseDown(e)) return;\n\n    if (touchInProgress) {\n      // modern browsers will fire mousedown for touch events too\n      // we do not want this: touch is handled separately.\n      e.stopPropagation();\n      return false;\n    }\n    // for IE, left click == 1\n    // for Firefox, left click == 0\n    var isLeftButton =\n      (e.button === 1 && window.event !== null) || e.button === 0;\n    if (!isLeftButton) return;\n\n    smoothScroll.cancel();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    mouseX = point.x;\n    mouseY = point.y;\n\n    // We need to listen on document itself, since mouse can go outside of the\n    // window, and we will loose it\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    textSelection.capture(e.target || e.srcElement);\n\n    return false;\n  }\n\n  function onMouseMove(e) {\n    // no need to worry about mouse events when touch is happening\n    if (touchInProgress) return;\n\n    triggerPanStart();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    var dx = point.x - mouseX;\n    var dy = point.y - mouseY;\n\n    mouseX = point.x;\n    mouseY = point.y;\n\n    internalMoveBy(dx, dy);\n  }\n\n  function onMouseUp() {\n    textSelection.release();\n    triggerPanEnd();\n    releaseDocumentMouse();\n  }\n\n  function releaseDocumentMouse() {\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n    panstartFired = false;\n  }\n\n  function releaseTouches() {\n    document.removeEventListener('touchmove', handleTouchMove);\n    document.removeEventListener('touchend', handleTouchEnd);\n    document.removeEventListener('touchcancel', handleTouchEnd);\n    panstartFired = false;\n    multiTouch = false;\n    touchInProgress = false;\n  }\n\n  function onMouseWheel(e) {\n    // if client does not want to handle this event - just ignore the call\n    if (beforeWheel(e)) return;\n\n    smoothScroll.cancel();\n\n    var delta = e.deltaY;\n    if (e.deltaMode > 0) delta *= 100;\n\n    var scaleMultiplier = getScaleMultiplier(delta);\n\n    if (scaleMultiplier !== 1) {\n      var offset = transformOrigin\n        ? getTransformOriginOffset()\n        : getOffsetXY(e);\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n      e.preventDefault();\n    }\n  }\n\n  function getOffsetXY(e) {\n    var offsetX, offsetY;\n    // I tried using e.offsetX, but that gives wrong results for svg, when user clicks on a path.\n    var ownerRect = owner.getBoundingClientRect();\n    offsetX = e.clientX - ownerRect.left;\n    offsetY = e.clientY - ownerRect.top;\n\n    return { x: offsetX, y: offsetY };\n  }\n\n  function smoothZoom(clientX, clientY, scaleMultiplier) {\n    var fromValue = transform.scale;\n    var from = { scale: fromValue };\n    var to = { scale: scaleMultiplier * fromValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      },\n      done: triggerZoomEnd\n    });\n  }\n\n  function smoothZoomAbs(clientX, clientY, toScaleValue) {\n    var fromValue = transform.scale;\n    var from = { scale: fromValue };\n    var to = { scale: toScaleValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      }\n    });\n  }\n\n  function getTransformOriginOffset() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width * transformOrigin.x,\n      y: ownerRect.height * transformOrigin.y\n    };\n  }\n\n  function publicZoomTo(clientX, clientY, scaleMultiplier) {\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n    return zoomByRatio(clientX, clientY, scaleMultiplier);\n  }\n\n  function cancelZoomAnimation() {\n    if (zoomToAnimation) {\n      zoomToAnimation.cancel();\n      zoomToAnimation = null;\n    }\n  }\n\n  function getScaleMultiplier(delta) {\n    var sign = Math.sign(delta);\n    var deltaAdjustedSpeed = Math.min(0.25, Math.abs(speed * delta / 128));\n    return 1 - sign * deltaAdjustedSpeed;\n  }\n\n  function triggerPanStart() {\n    if (!panstartFired) {\n      triggerEvent('panstart');\n      panstartFired = true;\n      smoothScroll.start();\n    }\n  }\n\n  function triggerPanEnd() {\n    if (panstartFired) {\n      // we should never run smooth scrolling if it was multiTouch (pinch zoom animation):\n      if (!multiTouch) smoothScroll.stop();\n      triggerEvent('panend');\n    }\n  }\n\n  function triggerZoomEnd() {\n    triggerEvent('zoomend');\n  }\n\n  function triggerEvent(name) {\n    api.fire(name, api);\n  }\n}\n\nfunction parseTransformOrigin(options) {\n  if (!options) return;\n  if (typeof options === 'object') {\n    if (!isNumber(options.x) || !isNumber(options.y))\n      failTransformOrigin(options);\n    return options;\n  }\n\n  failTransformOrigin();\n}\n\nfunction failTransformOrigin(options) {\n  console.error(options);\n  throw new Error(\n    [\n      'Cannot parse transform origin.',\n      'Some good examples:',\n      '  \"center center\" can be achieved with {x: 0.5, y: 0.5}',\n      '  \"top center\" can be achieved with {x: 0.5, y: 0}',\n      '  \"bottom right\" can be achieved with {x: 1, y: 1}'\n    ].join('\\n')\n  );\n}\n\nfunction noop() { }\n\nfunction validateBounds(bounds) {\n  var boundsType = typeof bounds;\n  if (boundsType === 'undefined' || boundsType === 'boolean') return; // this is okay\n  // otherwise need to be more thorough:\n  var validBounds =\n    isNumber(bounds.left) &&\n    isNumber(bounds.top) &&\n    isNumber(bounds.bottom) &&\n    isNumber(bounds.right);\n\n  if (!validBounds)\n    throw new Error(\n      'Bounds object is not valid. It can be: ' +\n      'undefined, boolean (true|false) or an object {left, top, right, bottom}'\n    );\n}\n\nfunction isNumber(x) {\n  return Number.isFinite(x);\n}\n\n// IE 11 does not support isNaN:\nfunction isNaN(value) {\n  if (Number.isNaN) {\n    return Number.isNaN(value);\n  }\n\n  return value !== value;\n}\n\nfunction rigidScroll() {\n  return {\n    start: noop,\n    stop: noop,\n    cancel: noop\n  };\n}\n\nfunction autoRun() {\n  if (typeof document === 'undefined') return;\n\n  var scripts = document.getElementsByTagName('script');\n  if (!scripts) return;\n  var panzoomScript;\n\n  for (var i = 0; i < scripts.length; ++i) {\n    var x = scripts[i];\n    if (x.src && x.src.match(/\\bpanzoom(\\.min)?\\.js/)) {\n      panzoomScript = x;\n      break;\n    }\n  }\n\n  if (!panzoomScript) return;\n\n  var query = panzoomScript.getAttribute('query');\n  if (!query) return;\n\n  var globalName = panzoomScript.getAttribute('name') || 'pz';\n  var started = Date.now();\n\n  tryAttach();\n\n  function tryAttach() {\n    var el = document.querySelector(query);\n    if (!el) {\n      var now = Date.now();\n      var elapsed = now - started;\n      if (elapsed < 2000) {\n        // Let's wait a bit\n        setTimeout(tryAttach, 100);\n        return;\n      }\n      // If we don't attach within 2 seconds to the target element, consider it a failure\n      console.error('Cannot find the panzoom element', globalName);\n      return;\n    }\n    var options = collectOptions(panzoomScript);\n    console.log(options);\n    window[globalName] = createPanZoom(el, options);\n  }\n\n  function collectOptions(script) {\n    var attrs = script.attributes;\n    var options = {};\n    for (var j = 0; j < attrs.length; ++j) {\n      var attr = attrs[j];\n      var nameValue = getPanzoomAttributeNameValue(attr);\n      if (nameValue) {\n        options[nameValue.name] = nameValue.value;\n      }\n    }\n\n    return options;\n  }\n\n  function getPanzoomAttributeNameValue(attr) {\n    if (!attr.name) return;\n    var isPanZoomAttribute =\n      attr.name[0] === 'p' && attr.name[1] === 'z' && attr.name[2] === '-';\n\n    if (!isPanZoomAttribute) return;\n\n    var name = attr.name.substr(3);\n    var value = JSON.parse(attr.value);\n    return { name: name, value: value };\n  }\n}\n\nautoRun();\n\t\n},{\"./lib/createTextSelectionInterceptor.js\":2,\"./lib/domController.js\":3,\"./lib/kinetic.js\":4,\"./lib/svgController.js\":5,\"./lib/transform.js\":6,\"amator\":7,\"ngraph.events\":9,\"wheel\":10}],2:[function(require,module,exports){\n/**\n * Disallows selecting text.\n */\nmodule.exports = createTextSelectionInterceptor;\n\nfunction createTextSelectionInterceptor(useFake) {\n  if (useFake) {\n    return {\n      capture: noop,\n      release: noop\n    };\n  }\n\n  var dragObject;\n  var prevSelectStart;\n  var prevDragStart;\n  var wasCaptured = false;\n\n  return {\n    capture: capture,\n    release: release\n  };\n\n  function capture(domObject) {\n    wasCaptured = true;\n    prevSelectStart = window.document.onselectstart;\n    prevDragStart = window.document.ondragstart;\n\n    window.document.onselectstart = disabled;\n\n    dragObject = domObject;\n    dragObject.ondragstart = disabled;\n  }\n\n  function release() {\n    if (!wasCaptured) return;\n    \n    wasCaptured = false;\n    window.document.onselectstart = prevSelectStart;\n    if (dragObject) dragObject.ondragstart = prevDragStart;\n  }\n}\n\nfunction disabled(e) {\n  e.stopPropagation();\n  return false;\n}\n\nfunction noop() {}\n\n},{}],3:[function(require,module,exports){\nmodule.exports = makeDomController;\n\nmodule.exports.canAttach = isDomElement;\n\nfunction makeDomController(domElement, options) {\n  var elementValid = isDomElement(domElement); \n  if (!elementValid) {\n    throw new Error('panzoom requires DOM element to be attached to the DOM tree');\n  }\n\n  var owner = domElement.parentElement;\n  domElement.scrollTop = 0;\n  \n  if (!options.disableKeyboardInteraction) {\n    owner.setAttribute('tabindex', 0);\n  }\n\n  var api = {\n    getBBox: getBBox,\n    getOwner: getOwner,\n    applyTransform: applyTransform,\n  };\n  \n  return api;\n\n  function getOwner() {\n    return owner;\n  }\n\n  function getBBox() {\n    // TODO: We should probably cache this?\n    return  {\n      left: 0,\n      top: 0,\n      width: domElement.clientWidth,\n      height: domElement.clientHeight\n    };\n  }\n\n  function applyTransform(transform) {\n    // TODO: Should we cache this?\n    domElement.style.transformOrigin = '0 0 0';\n    domElement.style.transform = 'matrix(' +\n      transform.scale + ', 0, 0, ' +\n      transform.scale + ', ' +\n      transform.x + ', ' + transform.y + ')';\n  }\n}\n\nfunction isDomElement(element) {\n  return element && element.parentElement && element.style;\n}\n\n},{}],4:[function(require,module,exports){\n/**\n * Allows smooth kinetic scrolling of the surface\n */\nmodule.exports = kinetic;\n\nfunction kinetic(getPoint, scroll, settings) {\n  if (typeof settings !== 'object') {\n    // setting could come as boolean, we should ignore it, and use an object.\n    settings = {};\n  }\n\n  var minVelocity = typeof settings.minVelocity === 'number' ? settings.minVelocity : 5;\n  var amplitude = typeof settings.amplitude === 'number' ? settings.amplitude : 0.25;\n  var cancelAnimationFrame = typeof settings.cancelAnimationFrame === 'function' ? settings.cancelAnimationFrame : getCancelAnimationFrame();\n  var requestAnimationFrame = typeof settings.requestAnimationFrame === 'function' ? settings.requestAnimationFrame : getRequestAnimationFrame();\n\n  var lastPoint;\n  var timestamp;\n  var timeConstant = 342;\n\n  var ticker;\n  var vx, targetX, ax;\n  var vy, targetY, ay;\n\n  var raf;\n\n  return {\n    start: start,\n    stop: stop,\n    cancel: dispose\n  };\n\n  function dispose() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n  }\n\n  function start() {\n    lastPoint = getPoint();\n\n    ax = ay = vx = vy = 0;\n    timestamp = new Date();\n\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    // we start polling the point position to accumulate velocity\n    // Once we stop(), we will use accumulated velocity to keep scrolling\n    // an object.\n    ticker = requestAnimationFrame(track);\n  }\n\n  function track() {\n    var now = Date.now();\n    var elapsed = now - timestamp;\n    timestamp = now;\n\n    var currentPoint = getPoint();\n\n    var dx = currentPoint.x - lastPoint.x;\n    var dy = currentPoint.y - lastPoint.y;\n\n    lastPoint = currentPoint;\n\n    var dt = 1000 / (1 + elapsed);\n\n    // moving average\n    vx = 0.8 * dx * dt + 0.2 * vx;\n    vy = 0.8 * dy * dt + 0.2 * vy;\n\n    ticker = requestAnimationFrame(track);\n  }\n\n  function stop() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    var currentPoint = getPoint();\n\n    targetX = currentPoint.x;\n    targetY = currentPoint.y;\n    timestamp = Date.now();\n\n    if (vx < -minVelocity || vx > minVelocity) {\n      ax = amplitude * vx;\n      targetX += ax;\n    }\n\n    if (vy < -minVelocity || vy > minVelocity) {\n      ay = amplitude * vy;\n      targetY += ay;\n    }\n\n    raf = requestAnimationFrame(autoScroll);\n  }\n\n  function autoScroll() {\n    var elapsed = Date.now() - timestamp;\n\n    var moving = false;\n    var dx = 0;\n    var dy = 0;\n\n    if (ax) {\n      dx = -ax * Math.exp(-elapsed / timeConstant);\n\n      if (dx > 0.5 || dx < -0.5) moving = true;\n      else dx = ax = 0;\n    }\n\n    if (ay) {\n      dy = -ay * Math.exp(-elapsed / timeConstant);\n\n      if (dy > 0.5 || dy < -0.5) moving = true;\n      else dy = ay = 0;\n    }\n\n    if (moving) {\n      scroll(targetX + dx, targetY + dy);\n      raf = requestAnimationFrame(autoScroll);\n    }\n  }\n}\n\nfunction getCancelAnimationFrame() {\n  if (typeof cancelAnimationFrame === 'function') return cancelAnimationFrame;\n  return clearTimeout;\n}\n\nfunction getRequestAnimationFrame() {\n  if (typeof requestAnimationFrame === 'function') return requestAnimationFrame;\n\n  return function (handler) {\n    return setTimeout(handler, 16);\n  };\n}\n},{}],5:[function(require,module,exports){\nmodule.exports = makeSvgController;\nmodule.exports.canAttach = isSVGElement;\n\nfunction makeSvgController(svgElement, options) {\n  if (!isSVGElement(svgElement)) {\n    throw new Error('svg element is required for svg.panzoom to work');\n  }\n\n  var owner = svgElement.ownerSVGElement;\n  if (!owner) {\n    throw new Error(\n      'Do not apply panzoom to the root <svg> element. ' +\n      'Use its child instead (e.g. <g></g>). ' +\n      'As of March 2016 only FireFox supported transform on the root element');\n  }\n\n  if (!options.disableKeyboardInteraction) {\n    owner.setAttribute('tabindex', 0);\n  }\n\n  var api = {\n    getBBox: getBBox,\n    getScreenCTM: getScreenCTM,\n    getOwner: getOwner,\n    applyTransform: applyTransform,\n    initTransform: initTransform\n  };\n  \n  return api;\n\n  function getOwner() {\n    return owner;\n  }\n\n  function getBBox() {\n    var bbox =  svgElement.getBBox();\n    return {\n      left: bbox.x,\n      top: bbox.y,\n      width: bbox.width,\n      height: bbox.height,\n    };\n  }\n\n  function getScreenCTM() {\n    var ctm = owner.getCTM();\n    if (!ctm) {\n      // This is likely firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=873106\n      // The code below is not entirely correct, but still better than nothing\n      return owner.getScreenCTM();\n    }\n    return ctm;\n  }\n\n  function initTransform(transform) {\n    var screenCTM = svgElement.getCTM();\n\n    // The above line returns null on Firefox\n    if (screenCTM === null) {\n      screenCTM = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\").createSVGMatrix();\n    }\n\n    transform.x = screenCTM.e;\n    transform.y = screenCTM.f;\n    transform.scale = screenCTM.a;\n    owner.removeAttributeNS(null, 'viewBox');\n  }\n\n  function applyTransform(transform) {\n    svgElement.setAttribute('transform', 'matrix(' +\n      transform.scale + ' 0 0 ' +\n      transform.scale + ' ' +\n      transform.x + ' ' + transform.y + ')');\n  }\n}\n\nfunction isSVGElement(element) {\n  return element && element.ownerSVGElement && element.getCTM;\n}\n},{}],6:[function(require,module,exports){\nmodule.exports = Transform;\n\nfunction Transform() {\n  this.x = 0;\n  this.y = 0;\n  this.scale = 1;\n}\n\n},{}],7:[function(require,module,exports){\nvar BezierEasing = require('bezier-easing')\n\n// Predefined set of animations. Similar to CSS easing functions\nvar animations = {\n  ease:  BezierEasing(0.25, 0.1, 0.25, 1),\n  easeIn: BezierEasing(0.42, 0, 1, 1),\n  easeOut: BezierEasing(0, 0, 0.58, 1),\n  easeInOut: BezierEasing(0.42, 0, 0.58, 1),\n  linear: BezierEasing(0, 0, 1, 1)\n}\n\n\nmodule.exports = animate;\nmodule.exports.makeAggregateRaf = makeAggregateRaf;\nmodule.exports.sharedScheduler = makeAggregateRaf();\n\n\nfunction animate(source, target, options) {\n  var start = Object.create(null)\n  var diff = Object.create(null)\n  options = options || {}\n  // We let clients specify their own easing function\n  var easing = (typeof options.easing === 'function') ? options.easing : animations[options.easing]\n\n  // if nothing is specified, default to ease (similar to CSS animations)\n  if (!easing) {\n    if (options.easing) {\n      console.warn('Unknown easing function in amator: ' + options.easing);\n    }\n    easing = animations.ease\n  }\n\n  var step = typeof options.step === 'function' ? options.step : noop\n  var done = typeof options.done === 'function' ? options.done : noop\n\n  var scheduler = getScheduler(options.scheduler)\n\n  var keys = Object.keys(target)\n  keys.forEach(function(key) {\n    start[key] = source[key]\n    diff[key] = target[key] - source[key]\n  })\n\n  var durationInMs = typeof options.duration === 'number' ? options.duration : 400\n  var durationInFrames = Math.max(1, durationInMs * 0.06) // 0.06 because 60 frames pers 1,000 ms\n  var previousAnimationId\n  var frame = 0\n\n  previousAnimationId = scheduler.next(loop)\n\n  return {\n    cancel: cancel\n  }\n\n  function cancel() {\n    scheduler.cancel(previousAnimationId)\n    previousAnimationId = 0\n  }\n\n  function loop() {\n    var t = easing(frame/durationInFrames)\n    frame += 1\n    setValues(t)\n    if (frame <= durationInFrames) {\n      previousAnimationId = scheduler.next(loop)\n      step(source)\n    } else {\n      previousAnimationId = 0\n      setTimeout(function() { done(source) }, 0)\n    }\n  }\n\n  function setValues(t) {\n    keys.forEach(function(key) {\n      source[key] = diff[key] * t + start[key]\n    })\n  }\n}\n\nfunction noop() { }\n\nfunction getScheduler(scheduler) {\n  if (!scheduler) {\n    var canRaf = typeof window !== 'undefined' && window.requestAnimationFrame\n    return canRaf ? rafScheduler() : timeoutScheduler()\n  }\n  if (typeof scheduler.next !== 'function') throw new Error('Scheduler is supposed to have next(cb) function')\n  if (typeof scheduler.cancel !== 'function') throw new Error('Scheduler is supposed to have cancel(handle) function')\n\n  return scheduler\n}\n\nfunction rafScheduler() {\n  return {\n    next: window.requestAnimationFrame.bind(window),\n    cancel: window.cancelAnimationFrame.bind(window)\n  }\n}\n\nfunction timeoutScheduler() {\n  return {\n    next: function(cb) {\n      return setTimeout(cb, 1000/60)\n    },\n    cancel: function (id) {\n      return clearTimeout(id)\n    }\n  }\n}\n\nfunction makeAggregateRaf() {\n  var frontBuffer = new Set();\n  var backBuffer = new Set();\n  var frameToken = 0;\n\n  return {\n    next: next,\n    cancel: next,\n    clearAll: clearAll\n  }\n\n  function clearAll() {\n    frontBuffer.clear();\n    backBuffer.clear();\n    cancelAnimationFrame(frameToken);\n    frameToken = 0;\n  }\n\n  function next(callback) {\n    backBuffer.add(callback);\n    renderNextFrame();\n  }\n\n  function renderNextFrame() {\n    if (!frameToken) frameToken = requestAnimationFrame(renderFrame);\n  }\n\n  function renderFrame() {\n    frameToken = 0;\n\n    var t = backBuffer;\n    backBuffer = frontBuffer;\n    frontBuffer = t;\r\n\n    frontBuffer.forEach(function(callback) {\n      callback();\n    });\n    frontBuffer.clear();\n  }\n\n  function cancel(callback) {\n    backBuffer.delete(callback);\n  }\n}\n\n},{\"bezier-easing\":8}],8:[function(require,module,exports){\n/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gatan Renaudeau 2014 - 2015  MIT License\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === 'function';\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT; }\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1); }\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n   var currentSlope = getSlope(aGuessT, mX1, mX2);\n   if (currentSlope === 0.0) {\n     return aGuessT;\n   }\n   var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n   aGuessT -= currentX / currentSlope;\n }\n return aGuessT;\n}\n\nfunction LinearEasing (x) {\n  return x;\n}\n\nmodule.exports = function bezier (mX1, mY1, mX2, mY2) {\n  if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n\n  if (mX1 === mY1 && mX2 === mY2) {\n    return LinearEasing;\n  }\n\n  // Precompute samples table\n  var sampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  for (var i = 0; i < kSplineTableSize; ++i) {\n    sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n  }\n\n  function getTForX (aX) {\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  return function BezierEasing (x) {\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) {\n      return 0;\n    }\n    if (x === 1) {\n      return 1;\n    }\n    return calcBezier(getTForX(x), mY1, mY2);\n  };\n};\n\n},{}],9:[function(require,module,exports){\nmodule.exports = function eventify(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n\n},{}],10:[function(require,module,exports){\n/**\n * This module used to unify mouse wheel behavior between different browsers in 2014\n * Now it's just a wrapper around addEventListener('wheel');\n *\n * Usage:\n *  var addWheelListener = require('wheel').addWheelListener;\n *  var removeWheelListener = require('wheel').removeWheelListener;\n *  addWheelListener(domElement, function (e) {\n *    // mouse wheel event\n *  });\n *  removeWheelListener(domElement, function);\n */\n\nmodule.exports = addWheelListener;\n\n// But also expose \"advanced\" api with unsubscribe:\nmodule.exports.addWheelListener = addWheelListener;\nmodule.exports.removeWheelListener = removeWheelListener;\n\n\nfunction addWheelListener(element, listener, useCapture) {\n  element.addEventListener('wheel', listener, useCapture);\n}\n\nfunction removeWheelListener( element, listener, useCapture ) {\n  element.removeEventListener('wheel', listener, useCapture);\n}\n},{}]},{},[1])(1)\n});\n"]},"metadata":{},"sourceType":"script"}